{
  "version": 3,
  "file": "ng-eventstore-listing.js",
  "sources": [
    "ng://ng-eventstore-listing/out/components/template-components/header-footer-template/header-footer-template.component.ts",
    "ng://ng-eventstore-listing/out/components/template-components/item-template/item-template.component.ts",
    "ng://ng-eventstore-listing/out/enums/group-boolean-operator.ts",
    "ng://ng-eventstore-listing/out/enums/sort-direction.ts",
    "ng://ng-eventstore-listing/out/enums/filter-operator.ts",
    "ng://ng-eventstore-listing/out/ng-eventstore-listing.module.ts",
    "ng://ng-eventstore-listing/out/components/item-template-holder/item-template-holder.component.ts",
    "ng://ng-eventstore-listing/out/directives/template.directive.ts",
    "ng://ng-eventstore-listing/out/ng-eventstore-listing.component.ts",
    "ng://ng-eventstore-listing/out/services/playback-list.service.ts",
    "ng://ng-eventstore-listing/out/services/playback.service.ts",
    "ng://ng-eventstore-listing/out/services/push.service.ts",
    "ng://ng-eventstore-listing/out/services/socket.io.service.ts",
    "ng://ng-eventstore-listing/out/services/script.service.ts"
  ],
  "sourcesContent": [
    "import { EventEmitter, OnInit, ChangeDetectorRef } from '@angular/core';\n\nexport abstract class HeaderFooterTemplateComponent implements OnInit {\n  // Event Emitters\n  actionEmitter: EventEmitter<any> = new EventEmitter();\n  pageChangedEmitter: EventEmitter<any> = new EventEmitter();\n  filterEmitter: EventEmitter<any> = new EventEmitter();\n\n  // Pager\n  totalItemCount: number;\n  pageStart: number;\n  pageEnd: number;\n  pageIndex: number;\n  maxSize: number;\n  itemsPerPage: number;\n  actualItemCount: number;\n\n  data: any; // Immutable item\n  lookups: any;\n\n  invalidSearch: boolean;\n\n  constructor(private changeDetectorRef: ChangeDetectorRef) {\n  }\n\n  ngOnInit(): void { }\n\n  updatePageValues(): void {\n    this.pageStart = ((this.pageIndex - 1) * this.itemsPerPage) + 1;\n    this.pageEnd = Math.min((((this.pageIndex - 1) * this.itemsPerPage) + this.actualItemCount), this.totalItemCount);\n    this.changeDetectorRef.detectChanges();\n  }\n\n  onPageChanged = (event) => {\n    this.pageIndex = event;\n    this.updatePageValues();\n    this.pageChangedEmitter.emit(event);\n  }\n\n  onFilter = (event) => {\n    this.filterEmitter.emit(event);\n  }\n\n  onAction = (action: string, data?: any) => {\n    const actionData = {\n      action: action,\n      data: data\n    };\n    this.actionEmitter.emit(actionData);\n  }\n}\n",
    "import {\n  EventEmitter,\n  OnInit,\n  OnChanges,\n  SimpleChanges,\n  ChangeDetectorRef,\n} from '@angular/core';\n\nexport abstract class ItemTemplateComponent implements OnInit, OnChanges {\n  // Event Emitters\n  onUpdateEmitter: EventEmitter<any> = new EventEmitter();\n  onUpdateLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  onShowModalEmitter: EventEmitter<any> = new EventEmitter();\n  onDeleteEmitter: EventEmitter<any> = new EventEmitter();\n\n  idPropertyName: string;\n  data: any; // Immutable item\n  lookups: any;\n\n  _changeFn: (changes) => void;\n\n  constructor(protected changeDetectorRef?: ChangeDetectorRef) {}\n\n  ngOnInit(): void {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this._changeFn) {\n      this._changeFn(changes);\n    }\n\n    if (this.changeDetectorRef) {\n      this.changeDetectorRef.detectChanges();\n    }\n  }\n\n  registerChangeFunction = (changeFn: (changes) => void) => {\n    this._changeFn = changeFn;\n  }\n\n  onUpdate = (propertyName: string, actionData: any) => {\n    const actionEventEmitterData = {\n      propertyName: propertyName,\n      id: this.data.get(this.idPropertyName),\n      data: actionData,\n    };\n    this.onUpdateEmitter.emit(actionEventEmitterData);\n  }\n\n  onUpdateLookups = (lookup) => {\n    const actionEventEmitterData = {\n      lookup: lookup,\n    };\n    this.onUpdateLookupsEmitter.emit(actionEventEmitterData);\n  }\n\n  onShowModal = (modalName, data) => {\n    const actionEventEmitterData = {\n      modalName: modalName,\n      id: this.data.get(this.idPropertyName),\n      data: data,\n    };\n    this.onShowModalEmitter.emit(actionEventEmitterData);\n  }\n\n  onDelete = (actionData?: any) => {\n    const actionEventEmitterData = {\n      id: this.data.get(this.idPropertyName),\n      data: actionData,\n    };\n    this.onDeleteEmitter.emit(actionEventEmitterData);\n  }\n}\n",
    "export enum GroupBooleanOperator {\n  and = 'and',\n  or = 'or'\n}\n",
    "export enum SortDirection {\n  ASC = 'ASC',\n  DESC = 'DESC',\n}\n",
    "export enum FilterOperator {\n  range = 'range',\n  is = 'is',\n  any = 'any',\n  contains = 'contains',\n  endsWith = 'endsWith',\n  startsWith = 'startsWith',\n  arrayContains = 'arrayContains',\n}\n",
    "import { NgModule } from '@angular/core';\nimport { NgEventstoreListingComponent } from './ng-eventstore-listing.component';\nimport { ItemTemplateHolderComponent } from './components/item-template-holder/item-template-holder.component';\n\nimport { CommonModule } from '@angular/common';\nimport { TemplateDirective } from './directives/template.directive';\nimport { IO_TOKEN } from './services/socket.io.service';\n\nimport * as io from 'socket.io-client';\nimport { ScriptService } from './services/script.service';\nimport { PlaybackService } from './services/playback.service';\nimport { PlaybackListService } from './services/playback-list.service';\nimport { PushService } from './services/push.service';\n\n@NgModule({\n  declarations: [\n    NgEventstoreListingComponent,\n    ItemTemplateHolderComponent,\n    TemplateDirective,\n\n  ],\n  imports: [CommonModule],\n  exports: [\n    NgEventstoreListingComponent\n  ],\n  providers: [\n    ScriptService,\n    PlaybackService,\n    PlaybackListService,\n    PushService,\n    { provide: IO_TOKEN, useValue: io }\n  ]\n})\nexport class NgEventstoreListingModule {}\n",
    "import {\n  Component,\n  OnInit,\n  Input,\n  ViewChild,\n  ComponentFactoryResolver,\n  Output,\n  EventEmitter,\n  OnChanges,\n  ComponentRef,\n  SimpleChanges,\n  ChangeDetectionStrategy,\n  AfterViewInit,\n} from '@angular/core';\nimport { ItemTemplateComponent } from '../template-components/index';\nimport { TemplateDirective } from '../../directives/template.directive';\n\n@Component({\n  selector: 'lib-item-template-holder',\n  template: `<div class=\"row no-gutters\">\n  <div class=\"col-12\">\n    <ng-template libTemplateDirective></ng-template>\n  </div>\n</div>\n`,\n  styles: [``],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ItemTemplateHolderComponent\n  implements OnInit, OnChanges, AfterViewInit {\n  @Input() itemComponentClass: any;\n  @Input() data: any = {};\n  @Input() lookups: any = {};\n  @Output() updateEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() updateLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() showModalEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() deleteEmitter: EventEmitter<any> = new EventEmitter();\n\n  componentRef: ComponentRef<any>;\n  initialChanges: SimpleChanges;\n  @ViewChild(TemplateDirective) itemHost: TemplateDirective;\n\n  constructor(private componentFactoryResolver: ComponentFactoryResolver) {}\n\n  ngOnInit(): void {\n    // this.loadComponent();\n  }\n\n  ngAfterViewInit(): void {\n    this.loadComponent();\n    if (this.initialChanges) {\n      this.ngOnChanges(this.initialChanges);\n      this.initialChanges = undefined;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const self = this;\n    if (self.componentRef) {\n      const changesKeys = Object.keys(changes);\n      changesKeys.forEach((key) => {\n        (self.componentRef.instance as ItemTemplateComponent)[key] =\n          changes[key].currentValue;\n      });\n      (self.componentRef.instance as ItemTemplateComponent).ngOnChanges(\n        changes\n      );\n    } else {\n      this.initialChanges = changes;\n    }\n  }\n\n  loadComponent(): void {\n    const componentFactory = this.componentFactoryResolver.resolveComponentFactory(\n      this.itemComponentClass\n    );\n    const viewContainerRef = this.itemHost.viewContainerRef;\n    viewContainerRef.clear();\n\n    this.componentRef = viewContainerRef.createComponent(componentFactory);\n    (this.componentRef.instance as ItemTemplateComponent).data = this.data;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onUpdateEmitter = this.updateEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onUpdateLookupsEmitter = this.updateLookupsEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onShowModalEmitter = this.showModalEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onDeleteEmitter = this.deleteEmitter;\n    // (this.componentRef.instance as ItemTemplateComponent).idPropertyName = this.idPropertyName;\n    (this.componentRef\n      .instance as ItemTemplateComponent).lookups = this.lookups;\n    (this.componentRef.instance as ItemTemplateComponent).ngOnInit();\n  }\n}\n",
    "import { Directive, ViewContainerRef } from '@angular/core';\n\n@Directive({\n  selector: '[libTemplateDirective]'\n})\nexport class TemplateDirective {\n  constructor(public viewContainerRef: ViewContainerRef) { }\n}\n",
    "import {\n  Component,\n  OnInit,\n  Input,\n  Output,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  OnDestroy,\n} from '@angular/core';\n\nimport { switchMap, debounceTime } from 'rxjs/operators';\n\nimport {\n  SubscriptionConfiguration,\n  ListHeaderGroups,\n  Script,\n  PlaybackListResponse,\n  PlaybackList,\n  RowItem,\n  Filter,\n  Query,\n  Sort,\n  PlaybackListRequest,\n} from './models';\n\nimport { ScriptService } from './services/script.service';\nimport { PlaybackService } from './services/playback.service';\nimport { PlaybackListService } from './services/playback-list.service';\n\nimport * as Immutable from 'immutable';\nimport _defaultsDeep from 'lodash-es/defaultsDeep';\nimport _isEmpty from 'lodash-es/isEmpty';\nimport _isEqual from 'lodash-es/isEqual';\nimport _cloneDeep from 'lodash-es/cloneDeep';\nimport _clone from 'lodash-es/clone';\nimport _uniq from 'lodash-es/uniq';\nimport _merge from 'lodash-es/defaults';\nimport { Subscription } from 'rxjs/Subscription';\nimport { Subject } from 'rxjs/Subject';\n\n@Component({\n  selector: 'lib-ng-eventstore-listing',\n  template: `<!-- <div *ngIf=\"listHeaderGroups && listHeaderGroups.groups && listHeaderGroups.groups.length > 0\"  [class]=\"'row ' + (listHeaderGroups && listHeaderGroups.generalRowClassName ? listHeaderGroups.generalRowClassName : '')\">\n  <div class=\"col-12\">\n    <div class=\"header bg-white p-2\">\n      <div [class]=\"'row ' + listHeaderGroups.generalRowClassName\">\n        <div *ngFor=\"let listHeaderGroup of listHeaderGroups.groups\" [class]=\"listHeaderGroup.className\">\n          <div [class]=\"'row ' + listHeaderGroups.generalRowClassName\">\n            <div *ngFor=\"let listHeader of listHeaderGroup.listHeaders\" [class]=\"listHeader.className\">\n              <span (click)=\"onSort(listHeader.sortProperty)\" [ngClass]=\"{ 'sort-header': listHeader.sortProperty }\">{{ listHeader.displayName }} <i *ngIf=\"sortFields[listHeader.sortProperty] && sortFields[listHeader.sortProperty].icon\" [class]=\"'sort-icon ' + sortFields[listHeader.sortProperty].icon\"></i></span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div> -->\n<!-- <div [class]=\"'row ' + (listHeaderGroups && listHeaderGroups.generalRowClassName) ? listHeaderGroups.generalRowClassName : ''\" *ngFor=\"let item of dataList; trackBy: trackByFn\"> -->\n<div class=\"row\" *ngFor=\"let item of dataList; trackBy: trackByFn\">\n  <div class=\"col-12\">\n    <lib-item-template-holder\n      [data]=\"item\"\n      [itemComponentClass]=\"itemComponentClass\"\n      [lookups]=\"lookups\"\n      (updateEmitter)=\"onUpdate($event)\"\n      (updateLookupsEmitter)=\"onUpdateLookups($event)\"\n      (showModalEmitter)=\"onShowModal($event)\"\n      (deleteEmitter)=\"onDelete($event)\">\n    </lib-item-template-holder>\n  </div>\n</div>\n\n<div class=\"row\" *ngIf=\"!dataCount || dataCount === 0\">\n  <div class=\"col-12\">\n    <div class=\"row\">\n      <div class=\"col-12 no-results-container\">\n        <div class=\"text-center text-secondary\">\n          <span class=\"italic\">{{ emptyListDisplayText }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n`,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NgEventstoreListingComponent\n  implements OnInit, OnChanges, OnDestroy {\n  @Output() updateEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() updateLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() showModalEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() deleteEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() playbackListLoadedEmitter: EventEmitter<any> = new EventEmitter();\n\n  @Input() itemComponentClass: any;\n  @Input() lookups = {};\n  @Input() socketUrl: string;\n  @Input() playbackListBaseUrl: string;\n  @Input() scriptStore: Script[];\n  @Input() itemSubscriptionConfiguration: SubscriptionConfiguration;\n  @Input() listSubscriptionConfiguration: SubscriptionConfiguration;\n  @Input() playbackListName: string;\n  @Input() filters: Filter[] = null;\n  @Input() sort: Sort = null;\n  @Input() pageIndex = 1;\n  @Input() itemsPerPage: number;\n  @Input() responseBasePath = 'data';\n  @Input() emptyListDisplayText = 'No Results';\n\n  @Input() debugging = false;\n\n  dataList: Immutable.List<RowItem>;\n  dataCount: number;\n  dataTotalCount: number;\n  initialized = false;\n  getPlaybackListSubscription: Subscription;\n  getPlaybackListSubject: Subject<PlaybackListRequest> = new Subject();\n  subscriptionTokens: string[] = [];\n  playbackList: PlaybackList = {\n    get: (rowId: string, callback: (err, item) => void) => {\n      const rowIndex = this.dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      if (rowIndex > -1) {\n        const data = this.dataList.get(rowIndex);\n        if (data) {\n          callback(null, (data as any).toJS());\n        } else {\n          callback(null, {});\n        }\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`), null);\n      }\n    },\n    add: (\n      rowId: string,\n      revision: number,\n      data: any,\n      meta: any,\n      callback: (err?: any) => void\n    ) => {\n      const newEntry = {\n        rowId: rowId,\n        revision: revision,\n        data: data,\n        meta: meta,\n      };\n      this.dataList = this.dataList.push(Immutable.fromJS(newEntry));\n      this.changeDetectorRef.detectChanges();\n      callback();\n    },\n    update: (\n      rowId: string,\n      revision: number,\n      oldData: any,\n      newData: any,\n      meta: any,\n      callback: (err?) => void\n    ) => {\n      const rowIndex = this.dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      // oldData is Immutable\n      const newEntry = Immutable.fromJS({\n        rowId: rowId,\n        revision: revision,\n        data: {\n          ...oldData,\n          ...newData,\n        },\n        meta: meta,\n      });\n\n      if (this.debugging) {\n        console.log(newEntry);\n      }\n\n      if (rowIndex > -1) {\n        if (this.debugging) {\n          console.log(rowIndex);\n          console.log(newEntry);\n\n          console.log(this.dataList.toJS());\n        }\n        this.dataList = this.dataList.set(rowIndex, newEntry);\n\n        if (this.debugging) {\n          console.log(this.dataList.toJS());\n        }\n        this.changeDetectorRef.detectChanges();\n        callback();\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`));\n      }\n    },\n    delete: (rowId: string, callback: (error?: any) => void) => {\n      const rowIndex = this.dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      if (rowIndex > -1) {\n        this.dataList = this.dataList.remove(rowIndex);\n        callback(null);\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`));\n      }\n    },\n  };\n\n  stateFunctions = {\n    getState: (id: string) => {\n      const index = this.dataList.findIndex((row: any) => {\n        return row.get('rowId') === id;\n      });\n      return (this.dataList.get(index) as any).toJS();\n    },\n    setState: (id: string, data: any) => {\n      const index = this.dataList.findIndex((row: any) => {\n        return row.get('rowId') === id;\n      });\n      this.dataList = this.dataList.set(index, Immutable.fromJS(data));\n      this.changeDetectorRef.markForCheck();\n    },\n  };\n\n  constructor(\n    private changeDetectorRef: ChangeDetectorRef,\n    private scriptService: ScriptService,\n    private playbackService: PlaybackService,\n    private playbackListService: PlaybackListService\n  ) {}\n\n  ngOnInit() {\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const self = this;\n    if (!this.initialized) {\n      this._loadScripts();\n      this.playbackService.init(this.socketUrl);\n      this._initializeRequests();\n      this.initialized = true;\n    }\n\n    const changesKeys = Object.keys(changes);\n    changesKeys.forEach((key) => {\n      self[key] = changes[key].currentValue;\n      switch (key) {\n        case 'pageIndex':\n        case 'filters':\n        case 'sort': {\n          this.requestPlaybackList();\n          break;\n        }\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this._resetSubscriptions();\n  }\n\n  trackByFn(index: number, item: any) {\n    return item.get('rowId');\n  }\n\n  private _initializeRequests(): void {\n    this.getPlaybackListSubscription = this.getPlaybackListSubject\n      .pipe(\n        debounceTime(100),\n        switchMap((params) => {\n          return this.playbackListService.getPlaybackList(\n            this.playbackListBaseUrl,\n            params.playbackListName,\n            params.startIndex,\n            params.limit,\n            params.filters,\n            params.sort\n          );\n        })\n      )\n      .subscribe((res: any) => {\n        this.dataList = Immutable.fromJS(res.rows);\n        this.dataCount = res.rows.length;\n        this.dataTotalCount = res.count;\n\n        this._resetSubscriptions();\n        this._initSubscriptions();\n\n        this.changeDetectorRef.detectChanges();\n\n        this.playbackListLoadedEmitter.emit({\n          totalItems: this.dataTotalCount,\n          dataCount: this.dataCount,\n        });\n      });\n  }\n\n  getPlaybackList(\n    playbackListName: string,\n    startIndex: number,\n    limit: number,\n    filters?: Filter[],\n    sort?: Sort\n  ) {\n    const playbackListRequestParams: PlaybackListRequest = {\n      playbackListName: playbackListName,\n      startIndex: startIndex,\n      limit: limit,\n      filters: filters,\n      sort: sort,\n    };\n    this.getPlaybackListSubject.next(playbackListRequestParams);\n  }\n\n  requestPlaybackList() {\n    const startIndex = this.itemsPerPage * (this.pageIndex - 1);\n    this.getPlaybackList(\n      this.playbackListName,\n      startIndex,\n      this.itemsPerPage,\n      this.filters,\n      this.sort\n    );\n  }\n\n  private _loadScripts() {\n    if (this.scriptStore) {\n      this.scriptService.init(this.scriptStore);\n    }\n  }\n\n  private async _initSubscriptions() {\n    const self = this;\n    // Per row subscriptions\n    self.dataList.forEach(async (row: any) => {\n      const query: Query = _clone(self.itemSubscriptionConfiguration.query);\n      query.aggregateId = query.aggregateId.replace(\n        /{{rowId}}/g,\n        row.get('rowId')\n      );\n      this.subscriptionTokens.push(\n        await self.playbackService.registerForPlayback(\n          self.itemSubscriptionConfiguration.playbackScriptName,\n          self,\n          query,\n          self.stateFunctions,\n          row.get('revision') + 1,\n          self.playbackList\n        )\n      );\n    });\n\n    // List subscription\n    this.subscriptionTokens.push(\n      await self.playbackService.registerForPlayback(\n        self.listSubscriptionConfiguration.playbackScriptName,\n        self,\n        self.listSubscriptionConfiguration.query,\n        self.stateFunctions,\n        // TODO: Revision response from getPlaybackList\n        0,\n        self.playbackList\n      )\n    );\n  }\n\n  private _resetSubscriptions() {\n    this.subscriptionTokens.forEach((subscriptionToken) => {\n      this.playbackService.unRegisterForPlayback(subscriptionToken);\n    });\n    this.subscriptionTokens = [];\n  }\n\n  onUpdate(payload: any) {\n    this.updateEmitter.emit(payload);\n  }\n\n  onUpdateLookups(payload: any) {\n    this.updateLookupsEmitter.emit(payload);\n  }\n\n  onShowModal(payload: any) {\n    this.showModalEmitter.emit(payload);\n  }\n\n  onDelete(payload: any) {\n    this.deleteEmitter.emit(payload);\n  }\n}\n",
    "import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs/Observable';\nimport { Filter, Sort, PlaybackListResponse } from '../models';\n\n@Injectable()\nexport class PlaybackListService {\n  constructor(private http: HttpClient) {}\n\n  getPlaybackList(\n    playbackListBaseUrl: string,\n    playbackListName: string,\n    startIndex: number,\n    limit: number,\n    filters?: Filter[],\n    sort?: Sort\n  ): Observable<PlaybackListResponse> {\n    let url = `${playbackListBaseUrl}/playback-list/${playbackListName}?startIndex=${startIndex}&limit=${limit}`;\n\n    if (filters) {\n      url += `&filters=${JSON.stringify(filters)}`;\n    }\n\n    if (sort) {\n      console.log(sort);\n      url += `&sort=${JSON.stringify(sort)}`;\n    }\n\n    return this.http.get<PlaybackListResponse>(url);\n  }\n}\n",
    "import { Injectable } from '@angular/core';\nimport { ScriptService } from './script.service';\nimport { PushService } from './push.service';\nimport {\n  StateFunctions,\n  PlaybackList,\n  PlaybackRegistry,\n  Query,\n} from '../models';\n\n@Injectable()\nexport class PlaybackService {\n  private playbackRegistry: PlaybackRegistry = {};\n  constructor(\n    private scriptService: ScriptService,\n    private pushService: PushService\n  ) {}\n\n  init(socketUrl: string) {\n    this.pushService.init(socketUrl);\n  }\n\n  async unRegisterForPlayback(token) {\n    // unsubscribe from push\n    await this.pushService.unsubscribe(token);\n\n    // unregister from playback registry\n    delete this.playbackRegistry[token];\n  }\n\n  async registerForPlayback(\n    scriptName: string,\n    owner: object,\n    query: Query,\n    stateFunctions: StateFunctions,\n    offset?: number,\n    playbackList?: PlaybackList\n  ) {\n    // console.log(scriptName);\n    const script = await this.scriptService.getScript(scriptName);\n    // console.log(script);\n    // const playbackScript = window[script[0].meta.objectName];\n    // console.log(playbackScript);\n    const playbackScript = window[script.meta.objectName];\n    const subscriptionId = await this.pushService.subscribe(\n      query,\n      offset,\n      this,\n      (err, eventObj, owner2, token) => {\n        // owner is playbackservice\n        const self = owner2 as PlaybackService;\n        const registration = self.playbackRegistry[token];\n        // call the function\n        // const playbackList = self.createPlaybacklist(registration)\n\n        // if (typeof eventObj.stateType !== 'undefined' && eventObj.eventSource)\n        //   eventObj = eventObj.eventSource;\n\n        if (eventObj.context === 'states') {\n          //\n        } else {\n          const playbackFunction =\n            registration.playbackScript.playbackInterface[\n              eventObj.payload.name\n            ];\n\n          if (playbackFunction) {\n            const row = stateFunctions.getState(eventObj.aggregateId);\n            const state = row.data;\n            const funcs = {\n              emit: (targetQuery, payload, done) => {\n                done();\n              },\n              getPlaybackList: (\n                playbackListName: string,\n                callback: (err, playbackList: PlaybackList) => void\n              ) => {\n                if (registration.playbackList) {\n                  callback(null, registration.playbackList);\n                } else {\n                  callback(\n                    new Error(\n                      'PlaybackList does not exist in this registration'\n                    ),\n                    null\n                  );\n                }\n              },\n            };\n\n            const doneCallback = () => {\n              // stateFunctions.setState(row.rowId, row);\n            };\n\n            playbackFunction(state, eventObj, funcs, doneCallback);\n          }\n        }\n      }\n    );\n\n    // just use the subscriptionId to map the push subscription to the playback\n    this.playbackRegistry[subscriptionId] = {\n      playbackScript: playbackScript,\n      owner: owner,\n      registrationId: subscriptionId,\n      playbackList: playbackList,\n    };\n\n    console.log('subscribed to playback: ', subscriptionId, query);\n    return subscriptionId;\n  }\n}\n",
    "import { Injectable, Inject, NgZone } from '@angular/core';\nimport { IO_TOKEN } from './socket.io.service';\n\n// TODO: Make environment pluggable or derivable\n\n@Injectable()\nexport class PushService {\n  private ioPush: any;\n  private subscriptions: any = {};\n  constructor(@Inject(IO_TOKEN) private io: any, private ngZone: NgZone) {}\n\n  init(socketUrl: string) {\n    this.ioPush = this.io(`${socketUrl}/events`);\n\n    const self = this;\n    this.ioPush.on('message', (eventObj, token) => {\n      console.log('got message from push server: ', eventObj, token);\n      const clientTokens = Object.keys(self.subscriptions);\n      // redirect to mapped subscription/token callback\n      clientTokens.forEach((clientToken) => {\n        const sub = self.subscriptions[clientToken];\n        if (sub.token === token) {\n          // update next offset (from stream revision) for this subscription, so for reconnecting\n          if (!isNaN(eventObj.streamRevision)) {\n            sub.offset = eventObj.streamRevision + 1;\n          }\n          if (typeof sub.cb === 'function') {\n            sub.cb(undefined, eventObj, sub.owner, clientToken);\n          }\n\n          // iterate on monitors meta tags\n          const tags = Object.keys(sub.monitorTags);\n          tags.forEach((tag) => {\n            // check for state/eventSource._meta or event._meta\n            if (eventObj._meta && eventObj._meta.tag === tag) {\n              let reason = 'N/A';\n              if (typeof eventObj.eventType === 'string') {\n                reason = eventObj.eventType;\n              } else if (typeof eventObj.stateType === 'string') {\n                reason = eventObj.stateType;\n                if (\n                  eventObj.eventSource &&\n                  typeof eventObj.eventSource.eventType === 'string'\n                ) {\n                  reason += ` <- ${eventObj.eventSource.eventType}`;\n                }\n              }\n              // iterate on the monitors\n              const monitors = sub.monitorTags[tag];\n              monitors.forEach((monitor) => {\n                monitor.callback(reason, eventObj._meta);\n              });\n            }\n          });\n        }\n      });\n    });\n\n    console.log('SOCKET INIT');\n  }\n\n  async subscribe(query, offset, owner, cb) {\n    console.log('SUBSCRIBE!');\n    // await this.waitForSocketConnection();\n    const clientToken =\n      Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString();\n    // map new subscription, then try to subscribe to server asap\n    this.subscriptions[clientToken] = {\n      query: query,\n      offset: offset,\n      owner: owner,\n      cb: cb,\n      monitorTags: {},\n    };\n\n    const sub = this.subscriptions[clientToken];\n    if (sub && !sub.token) {\n      // build up proper subscribe request query\n      const subscriptionQuery = Object.assign(sub.query, {\n        offset: sub.offset,\n      });\n\n      console.log('SUBSCRIBE IS CALLED:', subscriptionQuery);\n      this.ioPush.emit('subscribe', subscriptionQuery, (token: string) => {\n        console.log('SUBSCRIBE EMIT');\n        if (token) {\n          console.log('Server Subscribed:', token, subscriptionQuery);\n          sub.token = token;\n        } else {\n          console.error('Subscribe error for query', subscriptionQuery);\n        }\n      });\n    }\n\n\n    return clientToken;\n  }\n\n  // async subscribeStreams() {\n  //   // await this.waitForSocketConnection();\n  //   if (this.ioPush.connected) {\n  //     // this.ioPush.on('connected', () => {\n  //     console.log(this.subscriptions);\n  //     const clientTokens = Object.keys(this.subscriptions);\n  //     clientTokens.forEach((clientToken) => {\n  //       const sub = this.subscriptions[clientToken];\n  //       // do server subsribe for those without tokens yet\n  //       if (!sub.token) {\n  //         // build up proper subscribe request query\n  //         const query = Object.assign(sub.query, {\n  //           offset: sub.offset,\n  //         });\n  //         console.log('SUBSCRIBE IS CALLED:', query);\n  //         this.ioPush.emit('subscribe', query, (token: string) => {\n  //           console.log('SUBSCRIBE EMIT');\n  //           if (token) {\n  //             console.log('Server Subscribed:', token, query);\n  //             sub.token = token;\n  //           } else {\n  //             console.error('Subscribe error for query', query);\n  //           }\n  //         });\n  //       }\n  //     });\n  //     // })\n  //   }\n  // }\n\n  unsubscribe(clientToken): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        // just do a force server unsubscribe and removal of subscription entry\n        const sub = this.subscriptions[clientToken];\n        if (sub) {\n          if (sub.token && this.ioPush.connected) {\n            //  NOTE: need to handle unsubscribe/emit errors\n            this.ioPush.emit('unsubscribe', sub.token, () => {\n                resolve();\n            });\n          }\n          delete this.subscriptions[clientToken];\n          resolve();\n          // console.log('Unsubscribed:', clientToken, subscriptions);\n        }\n        // no subscription\n        resolve();\n      } catch (error) {\n        reject(error);\n        console.error('error in unsubscribing: ', error);\n      }\n    });\n  }\n\n  // async waitForSocketConnection(): Promise<any> {\n  //   return new Promise((resolve, reject) => {\n  //     let timeout;\n  //     this.ngZone.runOutsideAngular(() => {\n  //       timeout = setTimeout(() => {\n  //         this.ngZone.run(() => {\n  //           console.error('IO Connectioned timedout');\n  //           reject();\n  //         });\n  //       }, 10000)\n  //     })\n\n\n  //     while(!this.ioPush.connected) {\n  //       console.log(this.ioPush);\n  //     }\n  //     clearTimeout(timeout);\n  //     return resolve();\n\n  //   })\n  // }\n\n  // monitorMeta(clientToken, tag, timeout, cb) {\n  //   const self = this;\n  //   const sub = self.subscriptions[clientToken];\n  //   if (sub && typeof tag === 'string' && typeof cb === 'function') {\n  //     const monitorToken =\n  //       Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString();\n  //     // setup monitor token/filter/callback mapping\n  //     if (!sub.monitorTags[tag]) { sub.monitorTags[tag] = []; }\n  //     sub.monitorTags[tag].push({\n  //       token: monitorToken,\n  //       callback: cb,\n  //     });\n  //     setTimeout(() => {\n  //       const sub = self.subscriptions[clientToken];\n  //       if (sub && Array.isArray(sub.monitorTags[tag])) {\n  //         const idx = sub.monitorTags[tag].findIndex(\n  //           (x) => x.token === monitorToken\n  //         );\n  //         if (idx != -1) { sub.monitorTags[tag].splice(idx, 1); }\n  //         if (sub.monitorTags[tag].length <= 0) { delete sub.monitorTags[tag]; }\n  //         // console.log('TAGS:', clientToken, sub.monitorTags);\n  //       }\n  //     }, timeout);\n  //   }\n  // }\n}\n",
    "import { InjectionToken } from '@angular/core';\n\nexport let IO_TOKEN = new InjectionToken<any>('io');\n",
    "import { Injectable } from '@angular/core';\nimport { Script } from '../models';\n\ndeclare var document: any;\n\n@Injectable()\nexport class ScriptService {\n  private scripts: any = {};\n\n  constructor() {}\n\n  init(scriptStore: Script[]) {\n    scriptStore.forEach((script: Script) => {\n      // console.log('SCRIPT STORE LOGGING');\n      this.scripts[script.name] = {\n        loaded: false,\n        src: script.src,\n        meta: script.meta,\n      };\n      this.load(script.name);\n    });\n  }\n\n  load(...scripts: string[]): Promise<any> {\n    const promises: any[] = [];\n    scripts.forEach((script) => promises.push(this.loadScript(script)));\n    return Promise.all(promises);\n  }\n\n  loadScript(name: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // resolve if already loaded\n      if (this.scripts[name].loaded) {\n        resolve({\n          script: name,\n          loaded: true,\n          status: 'Already Loaded',\n          meta: this.scripts[name].meta,\n        });\n      } else {\n        // load script\n        const script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = this.scripts[name].src;\n        if (script.readyState) {\n          // IE\n          script.onreadystatechange = () => {\n            if (\n              script.readyState === 'loaded' ||\n              script.readyState === 'complete'\n            ) {\n              script.onreadystatechange = null;\n              this.scripts[name].loaded = true;\n              resolve({\n                script: name,\n                loaded: true,\n                status: 'Loaded',\n                meta: this.scripts[name].meta,\n              });\n            }\n          };\n        } else {\n          // Others\n          script.onload = () => {\n            this.scripts[name].loaded = true;\n            resolve({\n              script: name,\n              loaded: true,\n              status: 'Loaded',\n              meta: this.scripts[name].meta,\n            });\n          };\n        }\n        script.onerror = (error: any) =>\n          resolve({\n            script: name,\n            loaded: false,\n            status: 'Loaded',\n            meta: this.scripts[name].meta,\n          });\n        document.getElementsByTagName('head')[0].appendChild(script);\n      }\n    });\n  }\n\n  getScript(scriptName: string) {\n    return this.scripts[scriptName];\n  }\n}\n"
  ],
  "names": [
    "tslib_1.__awaiter",
    "Immutable.fromJS",
    "io"
  ],
  "mappings": "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"
}
