{"version":3,"file":"ng-eventstore-listing.umd.js","sources":["../../../node_modules/tslib/tslib.es6.js","ng://ng-eventstore-listing/utils/helpers.ts","ng://ng-eventstore-listing/services/jquery.service.ts","ng://ng-eventstore-listing/services/script.service.ts","ng://ng-eventstore-listing/services/push.service.ts","ng://ng-eventstore-listing/services/playback.service.ts","ng://ng-eventstore-listing/services/playback-list.service.ts","ng://ng-eventstore-listing/ng-eventstore-listing.component.ts","ng://ng-eventstore-listing/directives/template.directive.ts","ng://ng-eventstore-listing/components/item-template-holder/item-template-holder.component.ts","ng://ng-eventstore-listing/services/socket.io.service.ts","ng://ng-eventstore-listing/ng-eventstore-listing.module.ts","ng://ng-eventstore-listing/enums/filter-operator.ts","ng://ng-eventstore-listing/enums/sort-direction.ts","ng://ng-eventstore-listing/enums/group-boolean-operator.ts","ng://ng-eventstore-listing/components/template-components/item-template/item-template.component.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","export const Helpers = {\n  generateToken: () => {\n    return Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString();\n  }\n};\n","import { InjectionToken } from '@angular/core';\n\nexport let JQ_TOKEN = new InjectionToken('jQuery');\n\ndeclare let jQuery: Object;\nexport function jQueryFactory() {\n  return jQuery;\n}\n\n","import { Injectable } from '@angular/core';\nimport { Script } from '../models';\n\ndeclare var document: any;\n\n@Injectable()\nexport class ScriptService {\n  private scripts: any = {};\n\n  constructor() {}\n\n  async init(scriptStore: Script[]) {\n    const promises = [];\n    scriptStore.forEach((script: Script) => {\n      // console.log('SCRIPT STORE LOGGING');\n      this.scripts[script.name] = {\n        loaded: false,\n        src: script.src,\n        meta: script.meta,\n      };\n      promises.push(this.load(script.name));\n    });\n\n    return await Promise.all(promises);\n  }\n\n  async load(...scripts: string[]): Promise<any> {\n    const promises: any[] = [];\n    scripts.forEach((script) => promises.push(this.loadScript(script)));\n    return await Promise.all(promises);\n  }\n\n  loadScript(name: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      // resolve if already loaded\n      if (this.scripts[name].loaded) {\n        // console.log('LOADED');\n        resolve({\n          script: name,\n          loaded: true,\n          status: 'Already Loaded',\n          meta: this.scripts[name].meta,\n        });\n      } else {\n        const existingScript = document.querySelectorAll(`head script[src=\"${this.scripts[name].src}\"]`);\n        if (existingScript.length === 0) {\n          // load script\n          const script = document.createElement('script');\n          script.type = 'text/javascript';\n          script.src = this.scripts[name].src;\n          if (script.readyState) {\n            // IE\n            script.onreadystatechange = () => {\n              // console.log('ON READYSTATECHANGE');\n              if (\n                script.readyState === 'loaded' ||\n                script.readyState === 'complete'\n              ) {\n                script.onreadystatechange = null;\n                this.scripts[name].loaded = true;\n                resolve({\n                  script: name,\n                  loaded: true,\n                  status: 'Loaded',\n                  meta: this.scripts[name].meta,\n                });\n              }\n            };\n          } else {\n            // Others\n            // console.log('ONLOAD');\n            script.onload = () => {\n              this.scripts[name].loaded = true;\n              resolve({\n                script: name,\n                loaded: true,\n                status: 'Loaded',\n                meta: this.scripts[name].meta,\n              });\n            };\n          }\n          script.onerror = (error: any) =>\n          console.log('ON ERROR', error);\n            resolve({\n              script: name,\n              loaded: false,\n              status: 'Loaded',\n              meta: this.scripts[name].meta,\n            });\n          document.getElementsByTagName('head')[0].appendChild(script);\n        } else {\n          // console.log('Script already exists');\n          resolve();\n        }\n      }\n    });\n  }\n\n  getScript(scriptName: string) {\n    return this.scripts[scriptName];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Helpers } from '../utils/helpers.js';\nimport _forOwn from 'lodash-es/forOwn';\nimport _clone from 'lodash-es/clone';\nimport * as io from 'socket.io-client';\n\n@Injectable()\nexport class PushService {\n  private ioPush: any;\n  private subscriptions: any = {};\n  constructor() { }\n\n  init(socketUrl: string) {\n    if (!this.ioPush) {\n      this.ioPush = io.connect(`${socketUrl}/events`);\n\n      this.ioPush.on('message', (eventObj) => {\n        this._processEvent(eventObj);\n      });\n\n      this.ioPush.on('reconnect', () => {\n        // console.log('TEST RECONNECTION');\n        // this.ioPush.emit('resubscribe', () => {\n          // console.log(this.subscriptions);\n          _forOwn(this.subscriptions, (sub) => {\n            const subscriptionQuery = Object.assign(sub.query, {\n              offset: sub.offset,\n            });\n\n            this.ioPush.emit('subscribe', subscriptionQuery, (token: string) => {\n              if (token) {\n                // console.log('Reconnected:', token, subscriptionQuery);\n                sub.token = token;\n              } else {\n                console.error('Reconnect error for query', subscriptionQuery);\n              }\n            });\n          });\n        // });\n      });\n    }\n  }\n\n  _processEvent(eventObj: any) {\n    const self = this;\n    // console.log('got message from push server: ', eventObj);\n    const queryKey = `${eventObj.context}.${eventObj.aggregate}.${eventObj.aggregateId}`;\n    const clientTokens = Object.keys(self.subscriptions);\n    // redirect to mapped subscription/token callback\n    clientTokens.forEach((clientToken) => {\n      const sub = self.subscriptions[clientToken];\n      if (sub) {\n        const subQueryKey = `${sub.query.context}.${sub.query.aggregate}.${sub.query.aggregateId}`;\n        if (subQueryKey === queryKey) {\n          // update next offset (from stream revision) for this subscription, so for reconnecting\n          if (!isNaN(eventObj.streamRevision)) {\n            sub.offset = eventObj.streamRevision + 1;\n          }\n          if (typeof sub.cb === 'function') {\n            sub.cb(undefined, eventObj, sub.owner, clientToken);\n          }\n\n          // iterate on monitors meta tags\n          const tags = Object.keys(sub.monitorTags);\n          tags.forEach((tag) => {\n            // check for state/eventSource._meta or event._meta\n            if (eventObj._meta && eventObj._meta.tag === tag) {\n              let reason = 'N/A';\n              if (typeof eventObj.eventType === 'string') {\n                reason = eventObj.eventType;\n              } else if (typeof eventObj.stateType === 'string') {\n                reason = eventObj.stateType;\n                if (\n                  eventObj.eventSource &&\n                  typeof eventObj.eventSource.eventType === 'string'\n                ) {\n                  reason += ` <- ${eventObj.eventSource.eventType}`;\n                }\n              }\n              // iterate on the monitors\n              const monitors = sub.monitorTags[tag];\n              monitors.forEach((monitor) => {\n                monitor.callback(reason, eventObj._meta);\n              });\n            }\n          });\n        }\n      }\n    });\n  }\n\n  subscribe(query, offset, owner, cb) {\n    // await this.waitForSocketConnection();\n    const pushToken = Helpers.generateToken();\n    // map new subscription, then try to subscribe to server asap\n    this.subscriptions[pushToken] = {\n      query: query,\n      offset: offset,\n      owner: owner,\n      cb: cb,\n      monitorTags: {},\n    };\n\n    const sub = this.subscriptions[pushToken];\n    if (sub && !sub.token) {\n      // build up proper subscribe request query\n      const subscriptionQuery = Object.assign(sub.query, {\n        offset: sub.offset,\n      });\n\n      this.ioPush.emit('subscribe', subscriptionQuery, ({ subscriptionToken, catchUpEvents }) => {\n        if (subscriptionToken) {\n          // console.log('Server Subscribed:', token, subscriptionQuery);\n          sub.token = subscriptionToken;\n        } else {\n          console.error('Subscribe error for query', subscriptionQuery);\n        }\n\n        if (catchUpEvents && catchUpEvents.length > 0) {\n          catchUpEvents.forEach((event) => {\n            cb(undefined, event, owner, pushToken);\n          });\n        }\n      });\n    }\n\n    return pushToken;\n  }\n\n  unsubscribe(pushTokens: string[]): Promise<void> {\n    const socketTokens = [];\n\n    pushTokens.forEach((pushToken) => {\n      if (this.subscriptions[pushToken]) {\n        const clientSubscription = _clone(this.subscriptions[pushToken]);\n        delete this.subscriptions[pushToken];\n\n        const sub = clientSubscription;\n        if (sub && sub.token) {\n          socketTokens.push(sub.token);\n        }\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      this.ioPush.emit('unsubscribe', socketTokens, () => {\n        resolve();\n      });\n    });\n  }\n}\n","import _clone from 'lodash-es/clone';\nimport { Helpers } from './../utils/helpers';\nimport { Injectable } from '@angular/core';\nimport { PushService } from './push.service';\nimport {\n  StateFunctions,\n  PlaybackList,\n  PlaybackRegistry,\n  Query,\n  ConditionalSubscriptionRegistry,\n  CustomPlaybackConfiguration\n} from '../models';\nimport { CustomPlaybackRegistry } from '../models/custom-playback-registry';\n\n@Injectable()\nexport class PlaybackService {\n  _playbackRegistry: PlaybackRegistry = {};\n  _conditionalSubscriptionRegistry: ConditionalSubscriptionRegistry = {};\n  _customPlaybackRegistry: CustomPlaybackRegistry = {};\n\n  constructor(\n    private pushService: PushService\n  ) {}\n\n  init(socketUrl: string) {\n    this.pushService.init(socketUrl);\n  }\n\n  async unregisterForPlayback(playbackTokens: string[]) {\n    // unregister from playback registry\n    const pushTokens = playbackTokens.map((playbackToken) => {\n      return this._playbackRegistry[playbackToken].pushSubscriptionId;\n    });\n\n    playbackTokens.forEach(async (token) => {\n      const rowId = this._playbackRegistry[token].rowId;\n\n      // console.log('BEFORE');\n      // console.log(this._conditionalSubscriptionRegistry);\n\n      if (rowId) {\n        delete this._conditionalSubscriptionRegistry[rowId];\n      }\n\n      // console.log('AFTER');\n      // console.log(this._conditionalSubscriptionRegistry);\n\n      // unsubscribe from push\n      delete this._playbackRegistry[token];\n    });\n\n    await this.pushService.unsubscribe(pushTokens);\n  }\n\n  async registerForPlayback(\n    owner: object,\n    scriptName: string,\n    query: Query,\n    stateFunctions: StateFunctions,\n    playbackList: PlaybackList,\n    streamRevisionFunction: (item: any) => number = (item) => 0,\n    rowId?: string,\n    conditionFunction?: (item: any) => boolean,\n    rowIdFunction?: (item: any) => string\n  ) {\n    const playbackSubscriptionId = Helpers.generateToken();\n\n    let rowData;\n    if (rowId) {\n      const aggregateId = rowId ? rowId : query.aggregateId;\n      rowData = await new Promise((resolve, reject) => {\n        playbackList.get(aggregateId, (error, item) => {\n          if (error) {\n            reject(error);\n          }\n          resolve(item);\n        });\n      });\n    }\n\n    let streamRevision;\n    let isConditionTrue;\n\n    if (rowData) {\n      streamRevision = streamRevisionFunction(rowData);\n      isConditionTrue = conditionFunction ? (conditionFunction(rowData) ? true : false) : undefined;\n    }\n\n    let pushSubscriptionId;\n    if (isConditionTrue === true || conditionFunction === undefined) {\n      pushSubscriptionId = await this.pushService.subscribe(\n        query,\n        streamRevision,\n        this,\n        async (err, eventObj, owner2) => {\n          // owner is playbackservice\n          const self = owner2 as PlaybackService;\n\n          // console.log(self._playbackRegistry);\n\n          const registration = self._playbackRegistry[playbackSubscriptionId];\n\n          if (registration) {\n            if (eventObj.aggregate === 'states') {\n              const thisScriptName = registration.scriptName;\n              const fromEvent = eventObj.payload._meta.fromEvent;\n              const eventName = fromEvent.payload.name;\n              const thisPlaybackScript = window[thisScriptName];\n              const playbackFunction = thisPlaybackScript.playbackInterface[eventName];\n\n              if (playbackFunction) {\n                if (registration.rowId) {\n                  eventObj.aggregateId = registration.rowId;\n                }\n                const state = eventObj.payload;\n                const funcs = {\n                  emit: (targetQuery, payload, done) => {\n                    done();\n                  },\n                  getPlaybackList: (\n                    playbackListName: string,\n                    callback: (err, playbackList: PlaybackList) => void\n                  ) => {\n                    if (registration.playbackList) {\n                      callback(null, registration.playbackList);\n                    } else {\n                      callback(\n                        new Error(\n                          'PlaybackList does not exist in this registration'\n                        ),\n                        null\n                      );\n                    }\n                  },\n                };\n\n                const doneCallback = () => {\n                  registration.playbackList.get(eventObj.aggregateId, (error, item) => {\n                    self._updateConditionalSubscriptions(eventObj.aggregateId, item);\n                  });\n                };\n\n                playbackFunction(state, fromEvent, funcs, doneCallback);\n\n                // Run custom playbackEvents if they exist\n                if (this._customPlaybackRegistry[eventName]) {\n                  this._customPlaybackRegistry[eventName].forEach((customPlaybackConfiguration: CustomPlaybackConfiguration) => {\n                    customPlaybackConfiguration.playbackFunction(fromEvent);\n                  });\n                }\n              }\n            } else {\n              const thisScriptName = registration.scriptName;\n              const thisPlaybackScript = window[thisScriptName];\n              const playbackFunction = thisPlaybackScript.playbackInterface[eventObj.payload.name];\n\n              if (playbackFunction) {\n                // Override aggregateId to handle other subscriptions\n                if (registration.rowId) {\n                  eventObj.aggregateId = registration.rowId;\n                }\n                const row = stateFunctions.getState(eventObj.aggregateId);\n                const state = row.data;\n                const funcs = {\n                  emit: (targetQuery, payload, done) => {\n                    done();\n                  },\n                  getPlaybackList: (\n                    playbackListName: string,\n                    callback: (err, playbackList: PlaybackList) => void\n                  ) => {\n                    if (registration.playbackList) {\n                      callback(null, registration.playbackList);\n                    } else {\n                      callback(\n                        new Error(\n                          'PlaybackList does not exist in this registration'\n                        ),\n                        null\n                      );\n                    }\n                  },\n                };\n\n                const doneCallback = () => {\n                  registration.playbackList.get(eventObj.aggregateId, (error, item) => {\n                    self._updateConditionalSubscriptions(eventObj.aggregateId, item);\n                  });\n                };\n\n                playbackFunction(state, eventObj, funcs, doneCallback);\n                // Run custom playbackEvents if they exist\n                if (this._customPlaybackRegistry[eventObj.payload.name]) {\n                  this._customPlaybackRegistry[eventObj.payload.name].forEach(\n                    (customPlaybackConfiguration: CustomPlaybackConfiguration) => {\n                      customPlaybackConfiguration.playbackFunction(eventObj);\n                    });\n                }\n              }\n            }\n          }\n        }\n      );\n    }\n\n    // If condition exists, register in conditional registry\n    if (conditionFunction) {\n      if (this._conditionalSubscriptionRegistry[rowId] && Array.isArray(this._conditionalSubscriptionRegistry[rowId])) {\n        this._conditionalSubscriptionRegistry[rowId].push({\n          playbackList: playbackList,\n          scriptName: scriptName,\n          owner: owner,\n          stateFunctions: stateFunctions,\n          query: query,\n          streamRevisionFunction: streamRevisionFunction,\n          conditionFunction: conditionFunction,\n          pushSubscriptionId: pushSubscriptionId,\n          playbackSubscriptionId: playbackSubscriptionId,\n          rowIdFunction: rowIdFunction\n        });\n      } else {\n        this._conditionalSubscriptionRegistry[rowId] = [{\n          playbackList: playbackList,\n          scriptName: scriptName,\n          owner: owner,\n          stateFunctions: stateFunctions,\n          query: query,\n          streamRevisionFunction: streamRevisionFunction,\n          conditionFunction: conditionFunction,\n          pushSubscriptionId: pushSubscriptionId,\n          playbackSubscriptionId: playbackSubscriptionId,\n          rowIdFunction: rowIdFunction\n        }];\n      }\n    }\n\n    this._playbackRegistry[playbackSubscriptionId] = {\n      owner: owner,\n      pushSubscriptionId: pushSubscriptionId,\n      playbackList: playbackList,\n      scriptName: scriptName,\n      rowId: rowId\n    };\n\n    return playbackSubscriptionId;\n  }\n\n  registerCustomPlaybacks(customPlaybackConfigurations: CustomPlaybackConfiguration[]) {\n    customPlaybackConfigurations.forEach((customPlaybackConfiguration: CustomPlaybackConfiguration) => {\n      if (!this._customPlaybackRegistry[customPlaybackConfiguration.eventName]) {\n        this._customPlaybackRegistry[customPlaybackConfiguration.eventName] = [];\n      }\n      this._customPlaybackRegistry[customPlaybackConfiguration.eventName].push(customPlaybackConfiguration);\n    });\n  }\n\n  resetCustomPlaybacks() {\n    this._customPlaybackRegistry = {};\n  }\n\n  _updateConditionalSubscriptions(rowId, rowData) {\n    const conditionalSubscriptions = this._conditionalSubscriptionRegistry[rowId] || [];\n    conditionalSubscriptions.forEach(async (conditionalSubscription) => {\n      if (!conditionalSubscription.pushSubscriptionId && conditionalSubscription.conditionFunction(rowData)) {\n        const offset = conditionalSubscription.streamRevisionFunction(rowData);\n\n        const subQuery = _clone(conditionalSubscription.query);\n\n        if (conditionalSubscription.rowIdFunction) {\n          subQuery.aggregateId = conditionalSubscription.rowIdFunction(rowData);\n        }\n\n        const pushSubscriptionId = this.pushService.subscribe(\n          subQuery,\n          offset,\n          this,\n          async (err, eventObj, owner2) => {\n            // owner is playbackservice\n            const self = owner2 as PlaybackService;\n            const registration = self._playbackRegistry[conditionalSubscription.playbackSubscriptionId];\n\n            if (eventObj.aggregate === 'states') {\n              const thisScriptName = registration.scriptName;\n              const fromEvent = eventObj.payload._meta.fromEvent;\n              const eventName = fromEvent.payload.name;\n              const thisPlaybackScript = window[thisScriptName];\n              const playbackFunction = thisPlaybackScript.playbackInterface[eventName];\n\n              if (playbackFunction) {\n                const state = eventObj.payload;\n                const funcs = {\n                  emit: (targetQuery, payload, done) => {\n                    done();\n                  },\n                  getPlaybackList: (\n                    playbackListName: string,\n                    callback: (err, playbackList: PlaybackList) => void\n                  ) => {\n                    if (registration.playbackList) {\n                      callback(null, registration.playbackList);\n                    } else {\n                      callback(\n                        new Error(\n                          'PlaybackList does not exist in this registration'\n                        ),\n                        null\n                      );\n                    }\n                  },\n                };\n\n                const doneCallback = () => {\n                };\n                playbackFunction(state, fromEvent, funcs, doneCallback);\n              }\n            } else {\n\n              const thisScriptName = registration.scriptName;\n              const thisPlaybackScript = window[thisScriptName];\n              const playbackFunction = thisPlaybackScript.playbackInterface[eventObj.payload.name];\n\n              if (playbackFunction) {\n                // Override aggregateId to handle other subscriptions\n                if (registration.rowId) {\n                  eventObj.aggregateId = registration.rowId;\n                }\n                const row = conditionalSubscription.stateFunctions.getState(eventObj.aggregateId);\n                const state = row.data;\n                const funcs = {\n                  emit: (targetQuery, payload, done) => {\n                    done();\n                  },\n                  getPlaybackList: (\n                    playbackListName: string,\n                    callback: (err, playbackList: PlaybackList) => void\n                  ) => {\n                    if (registration.playbackList) {\n                      callback(null, registration.playbackList);\n                    } else {\n                      callback(\n                        new Error(\n                          'PlaybackList does not exist in this registration'\n                        ),\n                        null\n                      );\n                    }\n                  },\n                };\n\n                const doneCallback = () => {\n                  // stateFunctions.setState(row.rowId, row);\n                };\n\n                playbackFunction(state, eventObj, funcs, doneCallback);\n              }\n            }\n          }\n        );\n\n        // just use the subscriptionId to map the push subscription to the playback\n        this._playbackRegistry[conditionalSubscription.playbackSubscriptionId] = {\n          owner: conditionalSubscription.owner,\n          pushSubscriptionId: pushSubscriptionId,\n          playbackList: conditionalSubscription.playbackList,\n          scriptName: conditionalSubscription.scriptName,\n          rowId: rowId\n        };\n\n        conditionalSubscription.pushSubscriptionId = pushSubscriptionId;\n\n        // console.log('subscribed to playback: ', pushSubscriptionId, conditionalSubscription.query);\n        return pushSubscriptionId;\n      } else if (!conditionalSubscription.conditionFunction(rowData) && conditionalSubscription.pushSubscriptionId) {\n        this.pushService.unsubscribe([conditionalSubscription.pushSubscriptionId]).then(() => {\n          delete this._playbackRegistry[conditionalSubscription.playbackSubscriptionId];\n          conditionalSubscription.pushSubscriptionId = undefined;\n        });\n      }\n    });\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { Filter, Sort, PlaybackListResponse } from '../models';\n\n@Injectable()\nexport class PlaybackListService {\n  constructor(private http: HttpClient) {}\n\n  getPlaybackList(\n    playbackListBaseUrl: string,\n    playbackListName: string,\n    startIndex: number,\n    limit: number,\n    filters?: Filter[],\n    sort?: Sort[],\n    previousKey?: string,\n    nextKey?: string\n  ): Observable<PlaybackListResponse> {\n    let url = `${playbackListBaseUrl}/playback-list/${playbackListName}?startIndex=${startIndex}&limit=${limit}`;\n\n    if (filters) {\n      url += `&filters=${encodeURIComponent(JSON.stringify(filters))}`;\n    }\n\n    if (sort) {\n      url += `&sort=${JSON.stringify(sort)}`;\n    }\n\n    if (previousKey) {\n      url += '&previousKey=' + previousKey;\n    }\n\n    if (nextKey) {\n        url += '&nextKey=' + nextKey;\n    }\n\n    return this.http.get<PlaybackListResponse>(url);\n  }\n\n  getPlaybackListCsv(\n    playbackListBaseUrl: string,\n    playbackListName: string,\n    startIndex: number,\n    limit: number,\n    filters?: Filter[],\n    sort?: Sort[],\n    type?: string\n  ): Observable<any> {\n    let url = `${playbackListBaseUrl}/playback-list/${playbackListName}/export?startIndex=${startIndex}&limit=${limit}`;\n\n    if (filters) {\n      url += `&filters=${JSON.stringify(filters)}`;\n    }\n\n    if (sort) {\n      url += `&sort=${JSON.stringify(sort)}`;\n    }\n\n    if (type) {\n      url += `&type=${type}`;\n    }\n    return this.http.get<PlaybackListResponse>(url, <any>{ responseType: 'text/csv'});\n  }\n}\n","import { Helpers } from './utils/helpers';\nimport {\n  Component,\n  OnInit,\n  Input,\n  Output,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  OnDestroy,\n  Inject\n} from '@angular/core';\n\nimport { switchMap, debounceTime ,  map as rxMap } from 'rxjs/operators';\nimport { Subscription ,  Subject } from 'rxjs';\nimport { JQ_TOKEN } from './services/jquery.service';\n\nimport {\n  SubscriptionConfiguration,\n  Script,\n  PlaybackList,\n  RowItem,\n  Filter,\n  Query,\n  Sort,\n  PlaybackListRequest,\n  CustomPlaybackConfiguration,\n  PlaybackListResponse\n} from './models';\n\n\nimport { ScriptService } from './services/script.service';\nimport { PlaybackService } from './services/playback.service';\nimport { PlaybackListService } from './services/playback-list.service';\n\nimport * as Immutable from 'immutable';\nimport _defaultsDeep from 'lodash-es/defaultsDeep';\nimport _isEmpty from 'lodash-es/isEmpty';\nimport _isEqual from 'lodash-es/isEqual';\nimport _cloneDeep from 'lodash-es/cloneDeep';\nimport _clone from 'lodash-es/clone';\nimport _uniq from 'lodash-es/uniq';\nimport _merge from 'lodash-es/defaults';\nimport * as moment_ from 'moment-mini-ts';\n\nimport saveAs from 'file-saver';\n\n@Component({\n  selector: 'lib-ng-eventstore-listing',\n  templateUrl: './ng-eventstore-listing.component.html',\n  styleUrls: [\n    './ng-eventstore-listing.component.css'\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class NgEventstoreListingComponent\n  implements OnInit, OnChanges, OnDestroy {\n  @Output() updateEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() getLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() showModalEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() deleteEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() playbackListLoadedEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() newItemNotifyEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() removedItemNotifyEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() getPlaybackLIstErrorEmitter: EventEmitter<any> = new EventEmitter();\n\n  @Input() itemComponentClass: any;\n  @Input() lookups = {};\n  @Input() socketUrl: string;\n  @Input() playbackListBaseUrl: string;\n  @Input() scriptStore: Script[];\n  @Input() itemSubscriptionConfigurations: SubscriptionConfiguration[] = [];\n  @Input() listSubscriptionConfiguration: SubscriptionConfiguration;\n  @Input() playbackListName: string;\n  @Input() filters: Filter[] = null;\n  @Input() sort: Sort[] = null;\n  @Input() pageIndex = 1;\n  @Input() itemsPerPage: number;\n  @Input() responseBasePath = 'data';\n  @Input() emptyListDisplayText = 'No Results';\n  @Input() csvFileName = '';\n  @Input() customPlaybackConfigurations: CustomPlaybackConfiguration[];\n  @Input() enableLoadingOverlay = true;\n  @Input() loadingTopBoundSelector: string;\n  @Input() minHeightCss = '500px';\n  @Input() loadingOffset = '200px';\n\n  @Input() debugging = false;\n\n  _dataList: Immutable.List<RowItem>;\n  _dataCount: number;\n  _dataTotalCount: number;\n  _previousKey: string;\n  _nextKey: string;\n  _previousPageIndex: number;\n  _initialized = false;\n  _isLoading = false;\n  _getPlaybackListSubscription: Subscription;\n  _getPlaybackListSubject: Subject<PlaybackListRequest> = new Subject();\n  _exportPlaybackListSubscription: Subscription;\n  _exportPlaybackListSubject: Subject<any> = new Subject();\n  _playbackSubscriptionTokens: string[] = [];\n  _playbackList: PlaybackList = {\n    get: (rowId: string, callback: (err, item) => void) => {\n      const rowIndex = this._dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      if (rowIndex > -1) {\n        const data = this._dataList.get(rowIndex);\n        if (data) {\n          callback(null, (data as any).toJS());\n        } else {\n          callback(null, {});\n        }\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`), null);\n      }\n    },\n    add: (\n      rowId: string,\n      revision: number,\n      data: any,\n      meta: any,\n      callback: (err?: any) => void\n    ) => {\n      // const newEntry = {\n      //   rowId: rowId,\n      //   revision: revision,\n      //   data: data,\n      //   meta: meta,\n      // };\n      // this.dataList = this.dataList.push(Immutable.fromJS(newEntry));\n      // this.changeDetectorRef.detectChanges();\n      // Do refresh trigger\n      const newItem = {\n        rowId,\n        revision,\n        data,\n        meta\n      };\n      this.newItemNotifyEmitter.emit(newItem);\n      callback();\n    },\n    update: (\n      rowId: string,\n      revision: number,\n      oldData: any,\n      newData: any,\n      meta: any,\n      callback: (err?) => void\n    ) => {\n      const rowIndex = this._dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      // oldData is Immutable\n      const newEntry = Immutable.fromJS({\n        rowId: rowId,\n        revision: revision,\n        data: {\n          ...oldData,\n          ...newData,\n        },\n        meta: meta,\n      });\n\n      if (this.debugging) {\n        console.log(newEntry);\n      }\n\n      if (rowIndex > -1) {\n        if (this.debugging) {\n          console.log(rowIndex);\n          console.log(newEntry);\n\n          console.log(this._dataList.toJS());\n        }\n        this._dataList = this._dataList.set(rowIndex, newEntry);\n\n        if (this.debugging) {\n          console.log(this._dataList.toJS());\n        }\n        this.changeDetectorRef.detectChanges();\n        callback();\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`));\n      }\n    },\n    delete: (rowId: string, callback: (error?: any) => void) => {\n      const rowIndex = this._dataList.findIndex((value: any) => {\n        return value.get('rowId') === rowId;\n      });\n\n      if (rowIndex > -1) {\n        // this._dataList = this._dataList.remove(rowIndex);\n        this.removedItemNotifyEmitter.emit(rowId);\n        callback(null);\n      } else {\n        callback(new Error(`Row with rowId: ${rowIndex} does not exist`));\n      }\n    },\n  };\n\n  _id: string = Helpers.generateToken();\n\n  _stateFunctions = {\n    getState: (id: string) => {\n      const index = this._dataList.findIndex((row: any) => {\n        return row.get('rowId') === id;\n      });\n      if (index > 0) {\n        return (this._dataList.get(index) as any).toJS();\n      }\n\n      return {};\n    },\n    setState: (id: string, data: any) => {\n      const index = this._dataList.findIndex((row: any) => {\n        return row.get('rowId') === id;\n      });\n      this._dataList = this._dataList.set(index, Immutable.fromJS(data));\n      this.changeDetectorRef.markForCheck();\n    },\n  };\n\n  constructor(\n    @Inject(JQ_TOKEN) public $: any,\n    private changeDetectorRef: ChangeDetectorRef,\n    private scriptService: ScriptService,\n    private playbackService: PlaybackService,\n    private playbackListService: PlaybackListService\n  ) {}\n\n  async ngOnInit() {\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const self = this;\n\n    if (!self._initialized) {\n      this._initialized = true;\n      this._loadScripts().then(() => {\n        this._initializeRequests();\n        this.playbackService.init(this.socketUrl);\n        const changesKeys = Object.keys(changes);\n        changesKeys.forEach((key) => {\n          self[key] = changes[key].currentValue;\n          switch (key) {\n            case 'pageIndex':\n            case 'filters':\n            case 'sort': {\n              this.requestPlaybackList();\n              break;\n            }\n          }\n        });\n\n      });\n    } else {\n      const changesKeys = Object.keys(changes);\n      changesKeys.forEach((key) => {\n        if (key === 'pageIndex') {\n          self._previousPageIndex = changes[key].previousValue;\n        }\n        self[key] = changes[key].currentValue;\n        switch (key) {\n          case 'pageIndex':\n          case 'filters':\n          case 'sort':\n          case 'playbackListName': {\n            this.requestPlaybackList();\n            break;\n          }\n        }\n      });\n    }\n  }\n\n\n  ngOnDestroy() {\n    this._resetSubscriptions();\n    this.playbackService.resetCustomPlaybacks();\n    this._initialized = false;\n  }\n\n  trackByFn(index: number, item: any) {\n    return item.get('rowId');\n  }\n\n  private _initializeRequests(): void {\n    const self = this;\n    self._getPlaybackListSubscription = self._getPlaybackListSubject\n      .pipe(\n        debounceTime(100),\n        switchMap((params) => {\n          return self.playbackListService.getPlaybackList(\n            self.playbackListBaseUrl,\n            params.playbackListName,\n            params.startIndex,\n            params.limit,\n            params.filters,\n            params.sort,\n            params.previousKey,\n            params.nextKey\n          );\n        })\n      )\n      .subscribe((res: any) => {\n        self._dataList = Immutable.fromJS(res.rows);\n        self._dataCount = res.rows.length;\n        self._dataTotalCount = res.count;\n        self._previousKey = res.previousKey;\n        self._nextKey = res.nextKey;\n\n        self._resetSubscriptions();\n        self._initSubscriptions();\n        self._initCustomPlaybackConfigurations();\n\n        self.changeDetectorRef.detectChanges();\n\n        self.playbackListLoadedEmitter.emit({\n          totalItems: self._dataTotalCount,\n          dataCount: self._dataCount,\n        });\n\n        if (self.enableLoadingOverlay) {\n          self.hideLoadingOverlay();\n        }\n        self._isLoading = false;\n      }, (error: any) => {\n        self.getPlaybackLIstErrorEmitter.emit(error);\n        if (self.enableLoadingOverlay) {\n          self.hideLoadingOverlay();\n        }\n        self._isLoading = false;\n      });\n\n    self._exportPlaybackListSubscription = self._exportPlaybackListSubject\n    .pipe(\n      debounceTime(100),\n      switchMap((params) => {\n        const playbackListRequest = params.playbackListRequest;\n        return self.playbackListService.getPlaybackListCsv(\n          self.playbackListBaseUrl,\n          playbackListRequest.playbackListName,\n          playbackListRequest.startIndex,\n          playbackListRequest.limit,\n          playbackListRequest.filters,\n          playbackListRequest.sort,\n          playbackListRequest.type\n        ).pipe(\n          rxMap((response: PlaybackListResponse) => {\n            return [response, params.fileNameOverride];\n          })\n        );\n      })\n    )\n    .subscribe(([result, fileNameOverride]) => {\n      const csv = new Blob([result], { type: 'text/csv' });\n      const moment = moment_;\n      const now = moment();\n      const fileName = `${fileNameOverride || this.csvFileName || this.playbackListName}-${now.format('YYYY-MM-DD_HHmmss')}.csv`;\n      saveAs(csv, fileName);\n    });\n  }\n\n  _getPlaybackList(\n    playbackListName: string,\n    startIndex: number,\n    limit: number,\n    filters?: Filter[],\n    sort?: Sort[],\n    previousKey?: string,\n    nextKey?: string\n  ) {\n    const playbackListRequestParams: PlaybackListRequest = {\n      playbackListName: playbackListName,\n      startIndex: startIndex,\n      limit: limit,\n      filters: filters,\n      sort: sort,\n      previousKey: previousKey,\n      nextKey: nextKey\n    };\n    this._isLoading = true;\n    if (this.enableLoadingOverlay) {\n      this.showLoadingOverlay();\n    }\n    this._getPlaybackListSubject.next(playbackListRequestParams);\n  }\n\n  requestPlaybackList() {\n    let startIndex;\n    if (this.pageIndex === 1) {\n      this._previousPageIndex = null;\n      this._previousKey = null;\n      this._nextKey = null;\n      startIndex = 0;\n      this._getPlaybackList(\n        this.playbackListName,\n        startIndex,\n        this.itemsPerPage,\n        this.filters,\n        this.sort,\n        null,\n        null\n      );\n    } else if (this._previousPageIndex) {\n      if (this._dataTotalCount - (this.pageIndex * this.itemsPerPage) <= 0) {\n        startIndex = 0;\n        this._getPlaybackList(\n          this.playbackListName,\n          startIndex,\n          this.itemsPerPage,\n          this.filters,\n          this.sort,\n          null,\n          '__LAST'\n        );\n      } else {\n        let pageDelta = this.pageIndex - this._previousPageIndex;\n        if (pageDelta < 0) {\n          pageDelta *= -1;\n          startIndex = this.itemsPerPage * (pageDelta - 1);\n          this._getPlaybackList(\n            this.playbackListName,\n            startIndex,\n            this.itemsPerPage,\n            this.filters,\n            this.sort,\n            this._previousKey,\n            null\n          );\n        } else {\n          startIndex = this.itemsPerPage * (pageDelta - 1);\n          this._getPlaybackList(\n            this.playbackListName,\n            startIndex,\n            this.itemsPerPage,\n            this.filters,\n            this.sort,\n            null,\n            this._nextKey\n          );\n        }\n      }\n    } else {\n      startIndex = this.itemsPerPage * (this.pageIndex - 1);\n      this._getPlaybackList(\n        this.playbackListName,\n        startIndex,\n        this.itemsPerPage,\n        this.filters,\n        this.sort,\n        null,\n        null\n      );\n    }\n  }\n\n  private async _loadScripts() {\n    if (this.scriptStore) {\n      await this.scriptService.init(this.scriptStore);\n    }\n  }\n\n  private async _initSubscriptions() {\n    const self = this;\n    // Per row subscriptions\n    (self.itemSubscriptionConfigurations || []).forEach((itemSubscriptionConfiguration: SubscriptionConfiguration) => {\n      if (itemSubscriptionConfiguration) {\n        self._dataList.forEach(async (row: any) => {\n          const streamRevisionFunction = itemSubscriptionConfiguration.streamRevisionFunction ?\n            itemSubscriptionConfiguration.streamRevisionFunction : () => +row.get('revision') + 1;\n\n\n          const aggregateId = itemSubscriptionConfiguration.rowIdFunction ?\n              itemSubscriptionConfiguration.rowIdFunction(row.toJS()) : row.get('rowId');\n\n          const query: Query = _clone(itemSubscriptionConfiguration.query);\n          query.aggregateId = query.aggregateId.replace(\n            /{{rowId}}/g,\n            aggregateId\n          );\n\n          const playbackSubscriptionToken = await self.playbackService.registerForPlayback(\n            self,\n            itemSubscriptionConfiguration.playbackScriptName,\n            query,\n            self._stateFunctions,\n            self._playbackList,\n            streamRevisionFunction,\n            row.get('rowId'),\n            itemSubscriptionConfiguration.condition,\n            itemSubscriptionConfiguration.rowIdFunction\n          );\n          this._playbackSubscriptionTokens.push(playbackSubscriptionToken);\n        });\n      }\n    });\n\n    if (self.listSubscriptionConfiguration) {\n      // List subscription\n      this._playbackSubscriptionTokens.push(\n        await self.playbackService.registerForPlayback(\n          self,\n          self.listSubscriptionConfiguration.playbackScriptName,\n          self.listSubscriptionConfiguration.query,\n          self._stateFunctions,\n          self._playbackList,\n          () => 0\n        )\n      );\n    }\n  }\n\n  private _initCustomPlaybackConfigurations() {\n    if (!_isEmpty(this.customPlaybackConfigurations)) {\n      this.playbackService.registerCustomPlaybacks(this.customPlaybackConfigurations);\n    }\n  }\n\n  _resetSubscriptions() {\n    this.playbackService.unregisterForPlayback(this._playbackSubscriptionTokens);\n    this._playbackSubscriptionTokens = [];\n  }\n\n  _onUpdate(payload: any) {\n    this.updateEmitter.emit(payload);\n  }\n\n  _onGetLookups(payload: any) {\n    this.getLookupsEmitter.emit(payload);\n  }\n\n  _onShowModal(payload: any) {\n    this.showModalEmitter.emit(payload);\n  }\n\n  _onDelete(payload: any) {\n    this.deleteEmitter.emit(payload);\n  }\n\n  exportCSV(overrideParams?: PlaybackListRequest, fileNameOverride?: string) {\n    if (overrideParams) {\n      this._exportPlaybackListSubject.next({ playbackListRequest: overrideParams, fileNameOverride: fileNameOverride });\n    } else {\n      const startIndex = this.itemsPerPage * (this.pageIndex - 1);\n      const exportPlaybackListRequestParams: PlaybackListRequest = {\n        playbackListName: this.playbackListName,\n        startIndex: startIndex,\n        limit: 1000000,\n        filters: this.filters,\n        sort: this.sort\n      };\n\n      this._exportPlaybackListSubject.next({ playbackListRequest: exportPlaybackListRequestParams, fileNameOverride: fileNameOverride });\n    }\n  }\n\n  // Loading Overlay Functions\n  hideLoadingOverlay() {\n    const $ = this.$;\n    $('body').css('overflow', '');\n    $('body').removeClass('loading-body');\n    $(`#ng-eventstore-listing-overlay-${this._id}`).hide();\n  }\n\n  showLoadingOverlay() {\n    const $ = this.$;\n    $(`#ng-eventstore-listing-overlay-${this._id}`).show();\n    if (this.loadingTopBoundSelector ? true : false) {\n      this._fixLoadingOverlayPosition();\n    }\n  }\n\n  _fixLoadingOverlayPosition() {\n    const $ = this.$;\n    const windowY = window.pageYOffset;\n    const pageHeaderSectionHeight = 53;\n    const pageHeaderSectionBottomY = $(this.loadingTopBoundSelector).offset().top + pageHeaderSectionHeight;\n    $('body').css('overflow', 'hidden');\n    $('body').addClass('loading-body');\n    if (windowY < pageHeaderSectionBottomY) {\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('position', 'absolute');\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('height', `${window.innerHeight}px`);\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('width', '100%');\n      const pageHeaderHeight = pageHeaderSectionHeight;\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('margin-top', `${pageHeaderHeight}px`);\n    } else {\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('position', 'fixed');\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('height', '100%');\n      $(`#ng-eventstore-listing-overlay-${this._id}`).css('margin-top', '0px');\n    }\n  }\n}\n","import { Directive, ViewContainerRef } from '@angular/core';\n\n@Directive({\n  selector: '[libTemplateDirective]'\n})\nexport class TemplateDirective {\n  constructor(public viewContainerRef: ViewContainerRef) { }\n}\n","import {\n  Component,\n  OnInit,\n  Input,\n  ViewChild,\n  ComponentFactoryResolver,\n  Output,\n  EventEmitter,\n  OnChanges,\n  ComponentRef,\n  SimpleChanges,\n  ChangeDetectionStrategy,\n  AfterViewInit,\n} from '@angular/core';\nimport { ItemTemplateComponent } from '../template-components/index';\nimport { TemplateDirective } from '../../directives/template.directive';\n\n@Component({\n  selector: 'lib-item-template-holder',\n  templateUrl: './item-template-holder.component.html',\n  styleUrls: ['./item-template-holder.component.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ItemTemplateHolderComponent\n  implements OnInit, OnChanges, AfterViewInit {\n  @Input() itemComponentClass: any;\n  @Input() data: any = {};\n  @Input() lookups: any = {};\n  @Output() updateEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() getLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() showModalEmitter: EventEmitter<any> = new EventEmitter();\n  @Output() deleteEmitter: EventEmitter<any> = new EventEmitter();\n\n  componentRef: ComponentRef<any>;\n  initialChanges: SimpleChanges;\n  @ViewChild(TemplateDirective, { static: false }) itemHost: TemplateDirective;\n\n  constructor(private componentFactoryResolver: ComponentFactoryResolver) {}\n\n  ngOnInit(): void {\n    // this.loadComponent();\n  }\n\n  ngAfterViewInit(): void {\n    this.loadComponent();\n    if (this.initialChanges) {\n      this.ngOnChanges(this.initialChanges);\n      this.initialChanges = undefined;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const self = this;\n    if (self.componentRef) {\n      const changesKeys = Object.keys(changes);\n      changesKeys.forEach((key) => {\n        (self.componentRef.instance as ItemTemplateComponent)[key] =\n          changes[key].currentValue;\n      });\n      (self.componentRef.instance as ItemTemplateComponent).ngOnChanges(\n        changes\n      );\n    } else {\n      this.initialChanges = changes;\n    }\n  }\n\n  loadComponent(): void {\n    const componentFactory = this.componentFactoryResolver.resolveComponentFactory(\n      this.itemComponentClass\n    );\n    const viewContainerRef = this.itemHost.viewContainerRef;\n    viewContainerRef.clear();\n\n    this.componentRef = viewContainerRef.createComponent(componentFactory);\n    (this.componentRef.instance as ItemTemplateComponent).data = this.data;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onUpdateEmitter = this.updateEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onGetLookupsEmitter = this.getLookupsEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onShowModalEmitter = this.showModalEmitter;\n    (this.componentRef\n      .instance as ItemTemplateComponent).onDeleteEmitter = this.deleteEmitter;\n    // (this.componentRef.instance as ItemTemplateComponent).idPropertyName = this.idPropertyName;\n    (this.componentRef\n      .instance as ItemTemplateComponent).lookups = this.lookups;\n    (this.componentRef.instance as ItemTemplateComponent).ngOnInit();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport * as io from 'socket.io-client';\n\n@Injectable()\nexport class SocketIoService {\n  // sockets = {};\n  constructor() { }\n  getSocketInstance(socketUrl) {\n    return io.connect(`${socketUrl}/events`);\n  //   if (!this.sockets[socketUrl]) {\n  //     this.sockets[socketUrl] = io.connect(`${socketUrl}/events`);\n  //   }\n  //   return this.sockets[socketUrl];\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgEventstoreListingComponent } from './ng-eventstore-listing.component';\nimport { ItemTemplateHolderComponent } from './components/item-template-holder/item-template-holder.component';\n\nimport { CommonModule } from '@angular/common';\nimport { TemplateDirective } from './directives/template.directive';\n// import { IO_TOKEN, SocketIoService } from './services/socket.io.service';\n\n// import * as io from 'socket.io-client';\nimport { ScriptService } from './services/script.service';\nimport { PlaybackService } from './services/playback.service';\nimport { PlaybackListService } from './services/playback-list.service';\nimport { PushService } from './services/push.service';\nimport { SocketIoService } from './services/socket.io.service';\nimport { jQueryFactory, JQ_TOKEN } from './services/jquery.service';\n\n@NgModule({\n  declarations: [\n    NgEventstoreListingComponent,\n    ItemTemplateHolderComponent,\n    TemplateDirective,\n\n  ],\n  imports: [CommonModule],\n  exports: [\n    NgEventstoreListingComponent\n  ],\n  providers: [\n    ScriptService,\n    PlaybackService,\n    PlaybackListService,\n    PushService,\n    SocketIoService,\n    { provide: JQ_TOKEN, useFactory: jQueryFactory }\n    // ,\n    // { provide: IO_TOKEN, useValue: io }\n  ]\n})\nexport class NgEventstoreListingModule {}\n","export enum FilterOperator {\n  range = 'range',\n  dateRange = 'dateRange',\n  is = 'is',\n  any = 'any',\n  contains = 'contains',\n  endsWith = 'endsWith',\n  startsWith = 'startsWith',\n  arrayContains = 'arrayContains',\n  exists = 'exists',\n  notExists = 'notExists'\n}\n","export enum SortDirection {\n  ASC = 'ASC',\n  DESC = 'DESC',\n}\n","export enum GroupBooleanOperator {\n  and = 'and',\n  or = 'or'\n}\n","import {\n  EventEmitter,\n  OnInit,\n  OnChanges,\n  SimpleChanges,\n  ChangeDetectorRef,\n} from '@angular/core';\n\nimport {\n  FormGroup, Validators, FormControl\n} from '@angular/forms';\n\nexport abstract class ItemTemplateComponent implements OnInit, OnChanges {\n  // Event Emitters\n  onUpdateEmitter: EventEmitter<any> = new EventEmitter();\n  onGetLookupsEmitter: EventEmitter<any> = new EventEmitter();\n  onShowModalEmitter: EventEmitter<any> = new EventEmitter();\n  onDeleteEmitter: EventEmitter<any> = new EventEmitter();\n\n  idPropertyName: string;\n  data: any; // Immutable item\n  lookups: any;\n  private _formGroup: FormGroup = new FormGroup({});\n  private _formGroupKeys: string[] = [];\n\n  _changeFn: (changes) => void;\n\n  constructor(protected changeDetectorRef?: ChangeDetectorRef) {}\n\n  ngOnInit(): void {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this._changeFn) {\n      this._changeFn(changes);\n    }\n\n    const dataChanges = changes.data ? changes.data.currentValue : null;\n    if (dataChanges && !changes.data.isFirstChange()) {\n      const dataObj = (dataChanges as any).toJS();\n\n      this._formGroupKeys.forEach((key) => {\n        const newValue = dataObj.data[key];\n        const oldValue = this._formGroup.get(key).value;\n\n        if (newValue !== oldValue) {\n          this._formGroup.get(key).setValue(newValue, { emit: false, onlySelf: true });\n        }\n      });\n\n    }\n\n\n    if (this.changeDetectorRef) {\n      this.changeDetectorRef.detectChanges();\n    }\n  }\n\n  registerChangeFunction = (changeFn: (changes) => void) => {\n    this._changeFn = changeFn;\n  }\n\n  onUpdate = (propertyName: string, actionData: any) => {\n    const actionEventEmitterData = {\n      propertyName: propertyName,\n      id: this.data.get(this.idPropertyName),\n      data: actionData,\n    };\n    this.onUpdateEmitter.emit(actionEventEmitterData);\n  }\n\n  onGetLookups = (lookupName: string, callback: (payload: any) => void) => {\n    const actionEventEmitterData = {\n      lookupName: lookupName,\n      callback: callback\n    };\n    this.onGetLookupsEmitter.emit(actionEventEmitterData);\n  }\n\n  onShowModal = (modalName, data) => {\n    const actionEventEmitterData = {\n      modalName: modalName,\n      id: this.data.get(this.idPropertyName),\n      data: data,\n    };\n    this.onShowModalEmitter.emit(actionEventEmitterData);\n  }\n\n  onDelete = (actionData?: any) => {\n    const actionEventEmitterData = {\n      id: this.data.get(this.idPropertyName),\n      data: actionData,\n    };\n    this.onDeleteEmitter.emit(actionEventEmitterData);\n  }\n\n  // registerFormControl(propertyName: string)\n  registerFormGroup = (formGroup: FormGroup): void => {\n    this._formGroup = formGroup;\n  }\n\n  createFormControl(propertyName: string, initialValue: any, validators: Validators): FormControl {\n    const formControl = new FormControl(initialValue, validators);\n    this._formGroup.addControl(propertyName, formControl);\n    this._formGroupKeys.push(propertyName);\n    return formControl;\n  }\n\n}\n"],"names":["InjectionToken","Injectable","io.connect","HttpClient","EventEmitter","Subject","Immutable.fromJS","debounceTime","switchMap","rxMap","tslib_1.__decorate","Output","Input","Component","ChangeDetectionStrategy","tslib_1.__param","Inject","ChangeDetectorRef","Directive","ViewContainerRef","ViewChild","ComponentFactoryResolver","NgModule","CommonModule","FilterOperator","SortDirection","GroupBooleanOperator","FormGroup","FormControl"],"mappings":";;;;;;;;;;;IAAA;IACA;AACA;IACA;IACA;AACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AAeA;IACO,IAAI,QAAQ,GAAG,WAAW;IACjC,IAAI,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC,EAAE;IACrD,QAAQ,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IAC7D,YAAY,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;IAC7B,YAAY,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACzF,SAAS;IACT,QAAQ,OAAO,CAAC,CAAC;IACjB,MAAK;IACL,IAAI,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC3C,EAAC;AAaD;IACO,SAAS,UAAU,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE;IAC1D,IAAI,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,IAAI,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC;IACjI,IAAI,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU,EAAE,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IACnI,SAAS,KAAK,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;IACtJ,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAClE,CAAC;AACD;IACO,SAAS,OAAO,CAAC,UAAU,EAAE,SAAS,EAAE;IAC/C,IAAI,OAAO,UAAU,MAAM,EAAE,GAAG,EAAE,EAAE,SAAS,CAAC,MAAM,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC,EAAE;IACzE,CAAC;AACD;IACO,SAAS,UAAU,CAAC,WAAW,EAAE,aAAa,EAAE;IACvD,IAAI,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU,EAAE,OAAO,OAAO,CAAC,QAAQ,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IACnI,CAAC;AACD;IACO,SAAS,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,CAAC,EAAE,SAAS,EAAE;IAC7D,IAAI,SAAS,KAAK,CAAC,KAAK,EAAE,EAAE,OAAO,KAAK,YAAY,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,UAAU,OAAO,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAChH,IAAI,OAAO,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,UAAU,OAAO,EAAE,MAAM,EAAE;IAC/D,QAAQ,SAAS,SAAS,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;IACnG,QAAQ,SAAS,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;IACtG,QAAQ,SAAS,IAAI,CAAC,MAAM,EAAE,EAAE,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,EAAE;IACtH,QAAQ,IAAI,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;IAC9E,KAAK,CAAC,CAAC;IACP,CAAC;AACD;IACO,SAAS,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE;IAC3C,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACrH,IAAI,OAAO,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,OAAO,MAAM,KAAK,UAAU,KAAK,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,WAAW,EAAE,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC7J,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,EAAE,OAAO,UAAU,CAAC,EAAE,EAAE,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;IACtE,IAAI,SAAS,IAAI,CAAC,EAAE,EAAE;IACtB,QAAQ,IAAI,CAAC,EAAE,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAC;IACtE,QAAQ,OAAO,CAAC,EAAE,IAAI;IACtB,YAAY,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IACzK,YAAY,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;IACpD,YAAY,QAAQ,EAAE,CAAC,CAAC,CAAC;IACzB,gBAAgB,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,MAAM;IAC9C,gBAAgB,KAAK,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;IACxE,gBAAgB,KAAK,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;IACjE,gBAAgB,KAAK,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,SAAS;IACjE,gBAAgB;IAChB,oBAAoB,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,EAAE;IAChI,oBAAoB,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;IAC1G,oBAAoB,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,MAAM,EAAE;IACzF,oBAAoB,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE;IACvF,oBAAoB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;IAC1C,oBAAoB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,SAAS;IAC3C,aAAa;IACb,YAAY,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IACvC,SAAS,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,SAAS,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;IAClE,QAAQ,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IACzF,KAAK;IACL,CAAC;AAsBD;IACO,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;IAC7B,IAAI,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC/D,IAAI,IAAI,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;IACrB,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IACrC,IAAI,IAAI;IACR,QAAQ,OAAO,CAAC,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IACnF,KAAK;IACL,IAAI,OAAO,KAAK,EAAE,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE;IAC3C,YAAY;IACZ,QAAQ,IAAI;IACZ,YAAY,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D,SAAS;IACT,gBAAgB,EAAE,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;IACzC,KAAK;IACL,IAAI,OAAO,EAAE,CAAC;IACd;;aC5IiB;QACb,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC;IAC/E,CAAC;IAHI,IAAM,OAAO,GAAG;QACrB,aAAa,IAEZ;KACF;;QCFU,QAAQ,GAAG,IAAIA,mBAAc,CAAC,QAAQ,CAAC,CAAC;IAGnD,SAAgB,aAAa;QAC3B,OAAO,MAAM,CAAC;IAChB,CAAC;;;QCEC;YAFQ,YAAO,GAAQ,EAAE,CAAC;SAEV;QAEV,4BAAI,GAAV,UAAW,WAAqB;;;;;;;4BACxB,QAAQ,GAAG,EAAE,CAAC;4BACpB,WAAW,CAAC,OAAO,CAAC,UAAC,MAAc;;gCAEjC,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG;oCAC1B,MAAM,EAAE,KAAK;oCACb,GAAG,EAAE,MAAM,CAAC,GAAG;oCACf,IAAI,EAAE,MAAM,CAAC,IAAI;iCAClB,CAAC;gCACF,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;6BACvC,CAAC,CAAC;4BAEI,qBAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAA;gCAAlC,sBAAO,SAA2B,EAAC;;;;SACpC;QAEK,4BAAI,GAAV;YAAW,iBAAoB;iBAApB,UAAoB,EAApB,qBAAoB,EAApB,IAAoB;gBAApB,4BAAoB;;;;;;;;4BACvB,QAAQ,GAAU,EAAE,CAAC;4BAC3B,OAAO,CAAC,OAAO,CAAC,UAAC,MAAM,IAAK,OAAA,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,GAAA,CAAC,CAAC;4BAC7D,qBAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAA;gCAAlC,sBAAO,SAA2B,EAAC;;;;SACpC;QAED,kCAAU,GAAV,UAAW,IAAY;YAAvB,iBAgEC;YA/DC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;;gBAEjC,IAAI,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE;;oBAE7B,OAAO,CAAC;wBACN,MAAM,EAAE,IAAI;wBACZ,MAAM,EAAE,IAAI;wBACZ,MAAM,EAAE,gBAAgB;wBACxB,IAAI,EAAE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI;qBAC9B,CAAC,CAAC;iBACJ;qBAAM;oBACL,IAAM,cAAc,GAAG,QAAQ,CAAC,gBAAgB,CAAC,uBAAoB,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,QAAI,CAAC,CAAC;oBACjG,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE;;wBAE/B,IAAM,QAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;wBAChD,QAAM,CAAC,IAAI,GAAG,iBAAiB,CAAC;wBAChC,QAAM,CAAC,GAAG,GAAG,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC;wBACpC,IAAI,QAAM,CAAC,UAAU,EAAE;;4BAErB,QAAM,CAAC,kBAAkB,GAAG;;gCAE1B,IACE,QAAM,CAAC,UAAU,KAAK,QAAQ;oCAC9B,QAAM,CAAC,UAAU,KAAK,UAAU,EAChC;oCACA,QAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;oCACjC,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;oCACjC,OAAO,CAAC;wCACN,MAAM,EAAE,IAAI;wCACZ,MAAM,EAAE,IAAI;wCACZ,MAAM,EAAE,QAAQ;wCAChB,IAAI,EAAE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI;qCAC9B,CAAC,CAAC;iCACJ;6BACF,CAAC;yBACH;6BAAM;;;4BAGL,QAAM,CAAC,MAAM,GAAG;gCACd,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;gCACjC,OAAO,CAAC;oCACN,MAAM,EAAE,IAAI;oCACZ,MAAM,EAAE,IAAI;oCACZ,MAAM,EAAE,QAAQ;oCAChB,IAAI,EAAE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI;iCAC9B,CAAC,CAAC;6BACJ,CAAC;yBACH;wBACD,QAAM,CAAC,OAAO,GAAG,UAAC,KAAU;4BAC5B,OAAA,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,KAAK,CAAC;yBAAA,CAAC;wBAC7B,OAAO,CAAC;4BACN,MAAM,EAAE,IAAI;4BACZ,MAAM,EAAE,KAAK;4BACb,MAAM,EAAE,QAAQ;4BAChB,IAAI,EAAE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI;yBAC9B,CAAC,CAAC;wBACL,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,QAAM,CAAC,CAAC;qBAC9D;yBAAM;;wBAEL,OAAO,EAAE,CAAC;qBACX;iBACF;aACF,CAAC,CAAC;SACJ;QAED,iCAAS,GAAT,UAAU,UAAkB;YAC1B,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;SACjC;QA9FU,aAAa;YADzBC,eAAU,EAAE;;WACA,aAAa,CA+FzB;QAAD,oBAAC;KA/FD;;;QCIE;YADQ,kBAAa,GAAQ,EAAE,CAAC;SACf;QAEjB,0BAAI,GAAJ,UAAK,SAAiB;YAAtB,iBA6BC;YA5BC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAGC,uBAAU,CAAI,SAAS,YAAS,CAAC,CAAC;gBAEhD,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE,UAAC,QAAQ;oBACjC,KAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;iBAC9B,CAAC,CAAC;gBAEH,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE;;;;oBAIxB,OAAO,CAAC,KAAI,CAAC,aAAa,EAAE,UAAC,GAAG;wBAC9B,IAAM,iBAAiB,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE;4BACjD,MAAM,EAAE,GAAG,CAAC,MAAM;yBACnB,CAAC,CAAC;wBAEH,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,iBAAiB,EAAE,UAAC,KAAa;4BAC7D,IAAI,KAAK,EAAE;;gCAET,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC;6BACnB;iCAAM;gCACL,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,iBAAiB,CAAC,CAAC;6BAC/D;yBACF,CAAC,CAAC;qBACJ,CAAC,CAAC;;iBAEN,CAAC,CAAC;aACJ;SACF;QAED,mCAAa,GAAb,UAAc,QAAa;YACzB,IAAM,IAAI,GAAG,IAAI,CAAC;;YAElB,IAAM,QAAQ,GAAM,QAAQ,CAAC,OAAO,SAAI,QAAQ,CAAC,SAAS,SAAI,QAAQ,CAAC,WAAa,CAAC;YACrF,IAAM,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;;YAErD,YAAY,CAAC,OAAO,CAAC,UAAC,WAAW;gBAC/B,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;gBAC5C,IAAI,GAAG,EAAE;oBACP,IAAM,WAAW,GAAM,GAAG,CAAC,KAAK,CAAC,OAAO,SAAI,GAAG,CAAC,KAAK,CAAC,SAAS,SAAI,GAAG,CAAC,KAAK,CAAC,WAAa,CAAC;oBAC3F,IAAI,WAAW,KAAK,QAAQ,EAAE;;wBAE5B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;4BACnC,GAAG,CAAC,MAAM,GAAG,QAAQ,CAAC,cAAc,GAAG,CAAC,CAAC;yBAC1C;wBACD,IAAI,OAAO,GAAG,CAAC,EAAE,KAAK,UAAU,EAAE;4BAChC,GAAG,CAAC,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,GAAG,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;yBACrD;;wBAGD,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;wBAC1C,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG;;4BAEf,IAAI,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,EAAE;gCAChD,IAAI,QAAM,GAAG,KAAK,CAAC;gCACnB,IAAI,OAAO,QAAQ,CAAC,SAAS,KAAK,QAAQ,EAAE;oCAC1C,QAAM,GAAG,QAAQ,CAAC,SAAS,CAAC;iCAC7B;qCAAM,IAAI,OAAO,QAAQ,CAAC,SAAS,KAAK,QAAQ,EAAE;oCACjD,QAAM,GAAG,QAAQ,CAAC,SAAS,CAAC;oCAC5B,IACE,QAAQ,CAAC,WAAW;wCACpB,OAAO,QAAQ,CAAC,WAAW,CAAC,SAAS,KAAK,QAAQ,EAClD;wCACA,QAAM,IAAI,SAAO,QAAQ,CAAC,WAAW,CAAC,SAAW,CAAC;qCACnD;iCACF;;gCAED,IAAM,QAAQ,GAAG,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;gCACtC,QAAQ,CAAC,OAAO,CAAC,UAAC,OAAO;oCACvB,OAAO,CAAC,QAAQ,CAAC,QAAM,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC;iCAC1C,CAAC,CAAC;6BACJ;yBACF,CAAC,CAAC;qBACJ;iBACF;aACF,CAAC,CAAC;SACJ;QAED,+BAAS,GAAT,UAAU,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE;;YAEhC,IAAM,SAAS,GAAG,OAAO,CAAC,aAAa,EAAE,CAAC;;YAE1C,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG;gBAC9B,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE,MAAM;gBACd,KAAK,EAAE,KAAK;gBACZ,EAAE,EAAE,EAAE;gBACN,WAAW,EAAE,EAAE;aAChB,CAAC;YAEF,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;YAC1C,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE;;gBAErB,IAAM,mBAAiB,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE;oBACjD,MAAM,EAAE,GAAG,CAAC,MAAM;iBACnB,CAAC,CAAC;gBAEH,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,mBAAiB,EAAE,UAAC,EAAoC;wBAAlC,wCAAiB,EAAE,gCAAa;oBAClF,IAAI,iBAAiB,EAAE;;wBAErB,GAAG,CAAC,KAAK,GAAG,iBAAiB,CAAC;qBAC/B;yBAAM;wBACL,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,mBAAiB,CAAC,CAAC;qBAC/D;oBAED,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;wBAC7C,aAAa,CAAC,OAAO,CAAC,UAAC,KAAK;4BAC1B,EAAE,CAAC,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;yBACxC,CAAC,CAAC;qBACJ;iBACF,CAAC,CAAC;aACJ;YAED,OAAO,SAAS,CAAC;SAClB;QAED,iCAAW,GAAX,UAAY,UAAoB;YAAhC,iBAoBC;YAnBC,IAAM,YAAY,GAAG,EAAE,CAAC;YAExB,UAAU,CAAC,OAAO,CAAC,UAAC,SAAS;gBAC3B,IAAI,KAAI,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE;oBACjC,IAAM,kBAAkB,GAAG,MAAM,CAAC,KAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,CAAC;oBACjE,OAAO,KAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;oBAErC,IAAM,GAAG,GAAG,kBAAkB,CAAC;oBAC/B,IAAI,GAAG,IAAI,GAAG,CAAC,KAAK,EAAE;wBACpB,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;qBAC9B;iBACF;aACF,CAAC,CAAC;YAEH,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;gBACjC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,YAAY,EAAE;oBAC5C,OAAO,EAAE,CAAC;iBACX,CAAC,CAAC;aACJ,CAAC,CAAC;SACJ;QA9IU,WAAW;YADvBD,eAAU,EAAE;;WACA,WAAW,CA+IvB;QAAD,kBAAC;KA/ID;;;QCaE,yBACU,WAAwB;YAAxB,gBAAW,GAAX,WAAW,CAAa;YALlC,sBAAiB,GAAqB,EAAE,CAAC;YACzC,qCAAgC,GAAoC,EAAE,CAAC;YACvE,4BAAuB,GAA2B,EAAE,CAAC;SAIjD;QAEJ,8BAAI,GAAJ,UAAK,SAAiB;YACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAClC;QAEK,+CAAqB,GAA3B,UAA4B,cAAwB;;;;;;;4BAE5C,UAAU,GAAG,cAAc,CAAC,GAAG,CAAC,UAAC,aAAa;gCAClD,OAAO,KAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC,kBAAkB,CAAC;6BACjE,CAAC,CAAC;4BAEH,cAAc,CAAC,OAAO,CAAC,UAAO,KAAK;;;oCAC3B,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;;;oCAKlD,IAAI,KAAK,EAAE;wCACT,OAAO,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,CAAC;qCACrD;;;;oCAMD,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;;;iCACtC,CAAC,CAAC;4BAEH,qBAAM,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,EAAA;;4BAA9C,SAA8C,CAAC;;;;;SAChD;QAEK,6CAAmB,GAAzB,UACE,KAAa,EACb,UAAkB,EAClB,KAAY,EACZ,cAA8B,EAC9B,YAA0B,EAC1B,sBAA2D,EAC3D,KAAc,EACd,iBAA0C,EAC1C,aAAqC;YAHrC,uCAAA,EAAA,mCAAiD,IAAI,IAAK,OAAA,CAAC,GAAA;;;;;;;4BAKrD,sBAAsB,GAAG,OAAO,CAAC,aAAa,EAAE,CAAC;iCAGnD,KAAK,EAAL,wBAAK;4BACD,gBAAc,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC,WAAW,CAAC;4BAC5C,qBAAM,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;oCAC1C,YAAY,CAAC,GAAG,CAAC,aAAW,EAAE,UAAC,KAAK,EAAE,IAAI;wCACxC,IAAI,KAAK,EAAE;4CACT,MAAM,CAAC,KAAK,CAAC,CAAC;yCACf;wCACD,OAAO,CAAC,IAAI,CAAC,CAAC;qCACf,CAAC,CAAC;iCACJ,CAAC,EAAA;;4BAPF,OAAO,GAAG,SAOR,CAAC;;;4BAML,IAAI,OAAO,EAAE;gCACX,cAAc,GAAG,sBAAsB,CAAC,OAAO,CAAC,CAAC;gCACjD,eAAe,GAAG,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,CAAC,GAAG,IAAI,GAAG,KAAK,IAAI,SAAS,CAAC;6BAC/F;kCAGG,eAAe,KAAK,IAAI,IAAI,iBAAiB,KAAK,SAAS,CAAA,EAA3D,wBAA2D;4BACxC,qBAAM,IAAI,CAAC,WAAW,CAAC,SAAS,CACnD,KAAK,EACL,cAAc,EACd,IAAI,EACJ,UAAO,GAAG,EAAE,QAAQ,EAAE,MAAM;;;wCAEpB,IAAI,GAAG,MAAyB,CAAC;wCAIjC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,CAAC;wCAEpE,IAAI,YAAY,EAAE;4CAChB,IAAI,QAAQ,CAAC,SAAS,KAAK,QAAQ,EAAE;gDAC7B,cAAc,GAAG,YAAY,CAAC,UAAU,CAAC;gDACzC,cAAY,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC;gDAC7C,SAAS,GAAG,WAAS,CAAC,OAAO,CAAC,IAAI,CAAC;gDACnC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;gDAC5C,gBAAgB,GAAG,kBAAkB,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gDAEzE,IAAI,gBAAgB,EAAE;oDACpB,IAAI,YAAY,CAAC,KAAK,EAAE;wDACtB,QAAQ,CAAC,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC;qDAC3C;oDACK,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC;oDACzB,KAAK,GAAG;wDACZ,IAAI,EAAE,UAAC,WAAW,EAAE,OAAO,EAAE,IAAI;4DAC/B,IAAI,EAAE,CAAC;yDACR;wDACD,eAAe,EAAE,UACf,gBAAwB,EACxB,QAAmD;4DAEnD,IAAI,YAAY,CAAC,YAAY,EAAE;gEAC7B,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;6DAC3C;iEAAM;gEACL,QAAQ,CACN,IAAI,KAAK,CACP,kDAAkD,CACnD,EACD,IAAI,CACL,CAAC;6DACH;yDACF;qDACF,CAAC;oDAEI,YAAY,GAAG;wDACnB,YAAY,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,UAAC,KAAK,EAAE,IAAI;4DAC9D,IAAI,CAAC,+BAA+B,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;yDAClE,CAAC,CAAC;qDACJ,CAAC;oDAEF,gBAAgB,CAAC,KAAK,EAAE,WAAS,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;;oDAGxD,IAAI,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,EAAE;wDAC3C,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,2BAAwD;4DACvG,2BAA2B,CAAC,gBAAgB,CAAC,WAAS,CAAC,CAAC;yDACzD,CAAC,CAAC;qDACJ;iDACF;6CACF;iDAAM;gDACC,cAAc,GAAG,YAAY,CAAC,UAAU,CAAC;gDACzC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;gDAC5C,gBAAgB,GAAG,kBAAkB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gDAErF,IAAI,gBAAgB,EAAE;;oDAEpB,IAAI,YAAY,CAAC,KAAK,EAAE;wDACtB,QAAQ,CAAC,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC;qDAC3C;oDACK,GAAG,GAAG,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;oDACpD,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;oDACjB,KAAK,GAAG;wDACZ,IAAI,EAAE,UAAC,WAAW,EAAE,OAAO,EAAE,IAAI;4DAC/B,IAAI,EAAE,CAAC;yDACR;wDACD,eAAe,EAAE,UACf,gBAAwB,EACxB,QAAmD;4DAEnD,IAAI,YAAY,CAAC,YAAY,EAAE;gEAC7B,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;6DAC3C;iEAAM;gEACL,QAAQ,CACN,IAAI,KAAK,CACP,kDAAkD,CACnD,EACD,IAAI,CACL,CAAC;6DACH;yDACF;qDACF,CAAC;oDAEI,YAAY,GAAG;wDACnB,YAAY,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,UAAC,KAAK,EAAE,IAAI;4DAC9D,IAAI,CAAC,+BAA+B,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;yDAClE,CAAC,CAAC;qDACJ,CAAC;oDAEF,gBAAgB,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;;oDAEvD,IAAI,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;wDACvD,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,CACzD,UAAC,2BAAwD;4DACvD,2BAA2B,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;yDACxD,CAAC,CAAC;qDACN;iDACF;6CACF;yCACF;;;qCACF,CACF,EAAA;;4BAhHD,kBAAkB,GAAG,SAgHpB,CAAC;;;;4BAIJ,IAAI,iBAAiB,EAAE;gCACrB,IAAI,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,CAAC,EAAE;oCAC/G,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC;wCAChD,YAAY,EAAE,YAAY;wCAC1B,UAAU,EAAE,UAAU;wCACtB,KAAK,EAAE,KAAK;wCACZ,cAAc,EAAE,cAAc;wCAC9B,KAAK,EAAE,KAAK;wCACZ,sBAAsB,EAAE,sBAAsB;wCAC9C,iBAAiB,EAAE,iBAAiB;wCACpC,kBAAkB,EAAE,kBAAkB;wCACtC,sBAAsB,EAAE,sBAAsB;wCAC9C,aAAa,EAAE,aAAa;qCAC7B,CAAC,CAAC;iCACJ;qCAAM;oCACL,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,GAAG,CAAC;4CAC9C,YAAY,EAAE,YAAY;4CAC1B,UAAU,EAAE,UAAU;4CACtB,KAAK,EAAE,KAAK;4CACZ,cAAc,EAAE,cAAc;4CAC9B,KAAK,EAAE,KAAK;4CACZ,sBAAsB,EAAE,sBAAsB;4CAC9C,iBAAiB,EAAE,iBAAiB;4CACpC,kBAAkB,EAAE,kBAAkB;4CACtC,sBAAsB,EAAE,sBAAsB;4CAC9C,aAAa,EAAE,aAAa;yCAC7B,CAAC,CAAC;iCACJ;6BACF;4BAED,IAAI,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,GAAG;gCAC/C,KAAK,EAAE,KAAK;gCACZ,kBAAkB,EAAE,kBAAkB;gCACtC,YAAY,EAAE,YAAY;gCAC1B,UAAU,EAAE,UAAU;gCACtB,KAAK,EAAE,KAAK;6BACb,CAAC;4BAEF,sBAAO,sBAAsB,EAAC;;;;SAC/B;QAED,iDAAuB,GAAvB,UAAwB,4BAA2D;YAAnF,iBAOC;YANC,4BAA4B,CAAC,OAAO,CAAC,UAAC,2BAAwD;gBAC5F,IAAI,CAAC,KAAI,CAAC,uBAAuB,CAAC,2BAA2B,CAAC,SAAS,CAAC,EAAE;oBACxE,KAAI,CAAC,uBAAuB,CAAC,2BAA2B,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;iBAC1E;gBACD,KAAI,CAAC,uBAAuB,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;aACvG,CAAC,CAAC;SACJ;QAED,8CAAoB,GAApB;YACE,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;SACnC;QAED,yDAA+B,GAA/B,UAAgC,KAAK,EAAE,OAAO;YAA9C,iBAuHC;YAtHC,IAAM,wBAAwB,GAAG,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YACpF,wBAAwB,CAAC,OAAO,CAAC,UAAO,uBAAuB;;;;oBAC7D,IAAI,CAAC,uBAAuB,CAAC,kBAAkB,IAAI,uBAAuB,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE;wBAC/F,MAAM,GAAG,uBAAuB,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;wBAEjE,QAAQ,GAAG,MAAM,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;wBAEvD,IAAI,uBAAuB,CAAC,aAAa,EAAE;4BACzC,QAAQ,CAAC,WAAW,GAAG,uBAAuB,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;yBACvE;wBAEK,kBAAkB,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CACnD,QAAQ,EACR,MAAM,EACN,IAAI,EACJ,UAAO,GAAG,EAAE,QAAQ,EAAE,MAAM;;;gCAEpB,IAAI,GAAG,MAAyB,CAAC;gCACjC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,sBAAsB,CAAC,CAAC;gCAE5F,IAAI,QAAQ,CAAC,SAAS,KAAK,QAAQ,EAAE;oCAC7B,cAAc,GAAG,YAAY,CAAC,UAAU,CAAC;oCACzC,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC;oCAC7C,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC;oCACnC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;oCAC5C,gBAAgB,GAAG,kBAAkB,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;oCAEzE,IAAI,gBAAgB,EAAE;wCACd,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC;wCACzB,KAAK,GAAG;4CACZ,IAAI,EAAE,UAAC,WAAW,EAAE,OAAO,EAAE,IAAI;gDAC/B,IAAI,EAAE,CAAC;6CACR;4CACD,eAAe,EAAE,UACf,gBAAwB,EACxB,QAAmD;gDAEnD,IAAI,YAAY,CAAC,YAAY,EAAE;oDAC7B,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;iDAC3C;qDAAM;oDACL,QAAQ,CACN,IAAI,KAAK,CACP,kDAAkD,CACnD,EACD,IAAI,CACL,CAAC;iDACH;6CACF;yCACF,CAAC;wCAEI,YAAY,GAAG;yCACpB,CAAC;wCACF,gBAAgB,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;qCACzD;iCACF;qCAAM;oCAEC,cAAc,GAAG,YAAY,CAAC,UAAU,CAAC;oCACzC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;oCAC5C,gBAAgB,GAAG,kBAAkB,CAAC,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;oCAErF,IAAI,gBAAgB,EAAE;;wCAEpB,IAAI,YAAY,CAAC,KAAK,EAAE;4CACtB,QAAQ,CAAC,WAAW,GAAG,YAAY,CAAC,KAAK,CAAC;yCAC3C;wCACK,GAAG,GAAG,uBAAuB,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;wCAC5E,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;wCACjB,KAAK,GAAG;4CACZ,IAAI,EAAE,UAAC,WAAW,EAAE,OAAO,EAAE,IAAI;gDAC/B,IAAI,EAAE,CAAC;6CACR;4CACD,eAAe,EAAE,UACf,gBAAwB,EACxB,QAAmD;gDAEnD,IAAI,YAAY,CAAC,YAAY,EAAE;oDAC7B,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;iDAC3C;qDAAM;oDACL,QAAQ,CACN,IAAI,KAAK,CACP,kDAAkD,CACnD,EACD,IAAI,CACL,CAAC;iDACH;6CACF;yCACF,CAAC;wCAEI,YAAY,GAAG;;yCAEpB,CAAC;wCAEF,gBAAgB,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;qCACxD;iCACF;;;6BACF,CACF,CAAC;;wBAGF,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,sBAAsB,CAAC,GAAG;4BACvE,KAAK,EAAE,uBAAuB,CAAC,KAAK;4BACpC,kBAAkB,EAAE,kBAAkB;4BACtC,YAAY,EAAE,uBAAuB,CAAC,YAAY;4BAClD,UAAU,EAAE,uBAAuB,CAAC,UAAU;4BAC9C,KAAK,EAAE,KAAK;yBACb,CAAC;wBAEF,uBAAuB,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;;wBAGhE,sBAAO,kBAAkB,EAAC;qBAC3B;yBAAM,IAAI,CAAC,uBAAuB,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,uBAAuB,CAAC,kBAAkB,EAAE;wBAC5G,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,CAAC,CAAC,IAAI,CAAC;4BAC9E,OAAO,KAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,sBAAsB,CAAC,CAAC;4BAC9E,uBAAuB,CAAC,kBAAkB,GAAG,SAAS,CAAC;yBACxD,CAAC,CAAC;qBACJ;;;iBACF,CAAC,CAAC;SACJ;QA5WU,eAAe;YAD3BA,eAAU,EAAE;6CAOY,WAAW;WANvB,eAAe,CA8W3B;QAAD,sBAAC;KA9WD;;;QCRE,6BAAoB,IAAgB;YAAhB,SAAI,GAAJ,IAAI,CAAY;SAAI;QAExC,6CAAe,GAAf,UACE,mBAA2B,EAC3B,gBAAwB,EACxB,UAAkB,EAClB,KAAa,EACb,OAAkB,EAClB,IAAa,EACb,WAAoB,EACpB,OAAgB;YAEhB,IAAI,GAAG,GAAM,mBAAmB,uBAAkB,gBAAgB,oBAAe,UAAU,eAAU,KAAO,CAAC;YAE7G,IAAI,OAAO,EAAE;gBACX,GAAG,IAAI,cAAY,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAG,CAAC;aAClE;YAED,IAAI,IAAI,EAAE;gBACR,GAAG,IAAI,WAAS,IAAI,CAAC,SAAS,CAAC,IAAI,CAAG,CAAC;aACxC;YAED,IAAI,WAAW,EAAE;gBACf,GAAG,IAAI,eAAe,GAAG,WAAW,CAAC;aACtC;YAED,IAAI,OAAO,EAAE;gBACT,GAAG,IAAI,WAAW,GAAG,OAAO,CAAC;aAChC;YAED,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAuB,GAAG,CAAC,CAAC;SACjD;QAED,gDAAkB,GAAlB,UACE,mBAA2B,EAC3B,gBAAwB,EACxB,UAAkB,EAClB,KAAa,EACb,OAAkB,EAClB,IAAa,EACb,IAAa;YAEb,IAAI,GAAG,GAAM,mBAAmB,uBAAkB,gBAAgB,2BAAsB,UAAU,eAAU,KAAO,CAAC;YAEpH,IAAI,OAAO,EAAE;gBACX,GAAG,IAAI,cAAY,IAAI,CAAC,SAAS,CAAC,OAAO,CAAG,CAAC;aAC9C;YAED,IAAI,IAAI,EAAE;gBACR,GAAG,IAAI,WAAS,IAAI,CAAC,SAAS,CAAC,IAAI,CAAG,CAAC;aACxC;YAED,IAAI,IAAI,EAAE;gBACR,GAAG,IAAI,WAAS,IAAM,CAAC;aACxB;YACD,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAuB,GAAG,EAAO,EAAE,YAAY,EAAE,UAAU,EAAC,CAAC,CAAC;SACnF;QAzDU,mBAAmB;YAD/BA,eAAU,EAAE;6CAEeE,eAAU;WADzB,mBAAmB,CA0D/B;QAAD,0BAAC;KA1DD;;;QC8NE,sCAC2B,CAAM,EACvB,iBAAoC,EACpC,aAA4B,EAC5B,eAAgC,EAChC,mBAAwC;YALlD,iBAMI;YALuB,MAAC,GAAD,CAAC,CAAK;YACvB,sBAAiB,GAAjB,iBAAiB,CAAmB;YACpC,kBAAa,GAAb,aAAa,CAAe;YAC5B,oBAAe,GAAf,eAAe,CAAiB;YAChC,wBAAmB,GAAnB,mBAAmB,CAAqB;YA9KxC,kBAAa,GAAsB,IAAIC,iBAAY,EAAE,CAAC;YACtD,sBAAiB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAC1D,qBAAgB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YACzD,kBAAa,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YACtD,8BAAyB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAClE,yBAAoB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAC7D,6BAAwB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YACjE,gCAA2B,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAGrE,YAAO,GAAG,EAAE,CAAC;YAIb,mCAA8B,GAAgC,EAAE,CAAC;YAGjE,YAAO,GAAa,IAAI,CAAC;YACzB,SAAI,GAAW,IAAI,CAAC;YACpB,cAAS,GAAG,CAAC,CAAC;YAEd,qBAAgB,GAAG,MAAM,CAAC;YAC1B,yBAAoB,GAAG,YAAY,CAAC;YACpC,gBAAW,GAAG,EAAE,CAAC;YAEjB,yBAAoB,GAAG,IAAI,CAAC;YAE5B,iBAAY,GAAG,OAAO,CAAC;YACvB,kBAAa,GAAG,OAAO,CAAC;YAExB,cAAS,GAAG,KAAK,CAAC;YAQ3B,iBAAY,GAAG,KAAK,CAAC;YACrB,eAAU,GAAG,KAAK,CAAC;YAEnB,4BAAuB,GAAiC,IAAIC,YAAO,EAAE,CAAC;YAEtE,+BAA0B,GAAiB,IAAIA,YAAO,EAAE,CAAC;YACzD,gCAA2B,GAAa,EAAE,CAAC;YAC3C,kBAAa,GAAiB;gBAC5B,GAAG,EAAE,UAAC,KAAa,EAAE,QAA6B;oBAChD,IAAM,QAAQ,GAAG,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,KAAU;wBACnD,OAAO,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,KAAK,CAAC;qBACrC,CAAC,CAAC;oBAEH,IAAI,QAAQ,GAAG,CAAC,CAAC,EAAE;wBACjB,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;wBAC1C,IAAI,IAAI,EAAE;4BACR,QAAQ,CAAC,IAAI,EAAG,IAAY,CAAC,IAAI,EAAE,CAAC,CAAC;yBACtC;6BAAM;4BACL,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;yBACpB;qBACF;yBAAM;wBACL,QAAQ,CAAC,IAAI,KAAK,CAAC,qBAAmB,QAAQ,oBAAiB,CAAC,EAAE,IAAI,CAAC,CAAC;qBACzE;iBACF;gBACD,GAAG,EAAE,UACH,KAAa,EACb,QAAgB,EAChB,IAAS,EACT,IAAS,EACT,QAA6B;;;;;;;;;;oBAW7B,IAAM,OAAO,GAAG;wBACd,KAAK,OAAA;wBACL,QAAQ,UAAA;wBACR,IAAI,MAAA;wBACJ,IAAI,MAAA;qBACL,CAAC;oBACF,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACxC,QAAQ,EAAE,CAAC;iBACZ;gBACD,MAAM,EAAE,UACN,KAAa,EACb,QAAgB,EAChB,OAAY,EACZ,OAAY,EACZ,IAAS,EACT,QAAwB;oBAExB,IAAM,QAAQ,GAAG,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,KAAU;wBACnD,OAAO,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,KAAK,CAAC;qBACrC,CAAC,CAAC;;oBAGH,IAAM,QAAQ,GAAGC,gBAAgB,CAAC;wBAChC,KAAK,EAAE,KAAK;wBACZ,QAAQ,EAAE,QAAQ;wBAClB,IAAI,eACC,OAAO,EACP,OAAO,CACX;wBACD,IAAI,EAAE,IAAI;qBACX,CAAC,CAAC;oBAEH,IAAI,KAAI,CAAC,SAAS,EAAE;wBAClB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;qBACvB;oBAED,IAAI,QAAQ,GAAG,CAAC,CAAC,EAAE;wBACjB,IAAI,KAAI,CAAC,SAAS,EAAE;4BAClB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;4BACtB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;4BAEtB,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC;yBACpC;wBACD,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;wBAExD,IAAI,KAAI,CAAC,SAAS,EAAE;4BAClB,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC;yBACpC;wBACD,KAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;wBACvC,QAAQ,EAAE,CAAC;qBACZ;yBAAM;wBACL,QAAQ,CAAC,IAAI,KAAK,CAAC,qBAAmB,QAAQ,oBAAiB,CAAC,CAAC,CAAC;qBACnE;iBACF;gBACD,MAAM,EAAE,UAAC,KAAa,EAAE,QAA+B;oBACrD,IAAM,QAAQ,GAAG,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,KAAU;wBACnD,OAAO,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,KAAK,CAAC;qBACrC,CAAC,CAAC;oBAEH,IAAI,QAAQ,GAAG,CAAC,CAAC,EAAE;;wBAEjB,KAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;wBAC1C,QAAQ,CAAC,IAAI,CAAC,CAAC;qBAChB;yBAAM;wBACL,QAAQ,CAAC,IAAI,KAAK,CAAC,qBAAmB,QAAQ,oBAAiB,CAAC,CAAC,CAAC;qBACnE;iBACF;aACF,CAAC;YAEF,QAAG,GAAW,OAAO,CAAC,aAAa,EAAE,CAAC;YAEtC,oBAAe,GAAG;gBAChB,QAAQ,EAAE,UAAC,EAAU;oBACnB,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,GAAQ;wBAC9C,OAAO,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;qBAChC,CAAC,CAAC;oBACH,IAAI,KAAK,GAAG,CAAC,EAAE;wBACb,OAAQ,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAS,CAAC,IAAI,EAAE,CAAC;qBAClD;oBAED,OAAO,EAAE,CAAC;iBACX;gBACD,QAAQ,EAAE,UAAC,EAAU,EAAE,IAAS;oBAC9B,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,GAAQ;wBAC9C,OAAO,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;qBAChC,CAAC,CAAC;oBACH,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,EAAEA,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;oBACnE,KAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,CAAC;iBACvC;aACF,CAAC;SAQE;QAEE,+CAAQ,GAAd;;;;;;SACC;QAED,kDAAW,GAAX,UAAY,OAAsB;YAAlC,iBAwCC;YAvCC,IAAM,IAAI,GAAG,IAAI,CAAC;YAElB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC;oBACvB,KAAI,CAAC,mBAAmB,EAAE,CAAC;oBAC3B,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC;oBAC1C,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACzC,WAAW,CAAC,OAAO,CAAC,UAAC,GAAG;wBACtB,IAAI,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC;wBACtC,QAAQ,GAAG;4BACT,KAAK,WAAW,CAAC;4BACjB,KAAK,SAAS,CAAC;4BACf,KAAK,MAAM,EAAE;gCACX,KAAI,CAAC,mBAAmB,EAAE,CAAC;gCAC3B,MAAM;6BACP;yBACF;qBACF,CAAC,CAAC;iBAEJ,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACzC,WAAW,CAAC,OAAO,CAAC,UAAC,GAAG;oBACtB,IAAI,GAAG,KAAK,WAAW,EAAE;wBACvB,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,aAAa,CAAC;qBACtD;oBACD,IAAI,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC;oBACtC,QAAQ,GAAG;wBACT,KAAK,WAAW,CAAC;wBACjB,KAAK,SAAS,CAAC;wBACf,KAAK,MAAM,CAAC;wBACZ,KAAK,kBAAkB,EAAE;4BACvB,KAAI,CAAC,mBAAmB,EAAE,CAAC;4BAC3B,MAAM;yBACP;qBACF;iBACF,CAAC,CAAC;aACJ;SACF;QAGD,kDAAW,GAAX;YACE,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE,CAAC;YAC5C,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;SAC3B;QAED,gDAAS,GAAT,UAAU,KAAa,EAAE,IAAS;YAChC,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;SAC1B;QAEO,0DAAmB,GAA3B;YAAA,iBA2EC;YA1EC,IAAM,IAAI,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,uBAAuB;iBAC7D,IAAI,CACHC,sBAAY,CAAC,GAAG,CAAC,EACjBC,mBAAS,CAAC,UAAC,MAAM;gBACf,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAC7C,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,gBAAgB,EACvB,MAAM,CAAC,UAAU,EACjB,MAAM,CAAC,KAAK,EACZ,MAAM,CAAC,OAAO,EACd,MAAM,CAAC,IAAI,EACX,MAAM,CAAC,WAAW,EAClB,MAAM,CAAC,OAAO,CACf,CAAC;aACH,CAAC,CACH;iBACA,SAAS,CAAC,UAAC,GAAQ;gBAClB,IAAI,CAAC,SAAS,GAAGF,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC5C,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;gBAClC,IAAI,CAAC,eAAe,GAAG,GAAG,CAAC,KAAK,CAAC;gBACjC,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC,WAAW,CAAC;gBACpC,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC,OAAO,CAAC;gBAE5B,IAAI,CAAC,mBAAmB,EAAE,CAAC;gBAC3B,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC1B,IAAI,CAAC,iCAAiC,EAAE,CAAC;gBAEzC,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;gBAEvC,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC;oBAClC,UAAU,EAAE,IAAI,CAAC,eAAe;oBAChC,SAAS,EAAE,IAAI,CAAC,UAAU;iBAC3B,CAAC,CAAC;gBAEH,IAAI,IAAI,CAAC,oBAAoB,EAAE;oBAC7B,IAAI,CAAC,kBAAkB,EAAE,CAAC;iBAC3B;gBACD,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;aACzB,EAAE,UAAC,KAAU;gBACZ,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC7C,IAAI,IAAI,CAAC,oBAAoB,EAAE;oBAC7B,IAAI,CAAC,kBAAkB,EAAE,CAAC;iBAC3B;gBACD,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;aACzB,CAAC,CAAC;YAEL,IAAI,CAAC,+BAA+B,GAAG,IAAI,CAAC,0BAA0B;iBACrE,IAAI,CACHC,sBAAY,CAAC,GAAG,CAAC,EACjBC,mBAAS,CAAC,UAAC,MAAM;gBACf,IAAM,mBAAmB,GAAG,MAAM,CAAC,mBAAmB,CAAC;gBACvD,OAAO,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAChD,IAAI,CAAC,mBAAmB,EACxB,mBAAmB,CAAC,gBAAgB,EACpC,mBAAmB,CAAC,UAAU,EAC9B,mBAAmB,CAAC,KAAK,EACzB,mBAAmB,CAAC,OAAO,EAC3B,mBAAmB,CAAC,IAAI,EACxB,mBAAmB,CAAC,IAAI,CACzB,CAAC,IAAI,CACJC,aAAK,CAAC,UAAC,QAA8B;oBACnC,OAAO,CAAC,QAAQ,EAAE,MAAM,CAAC,gBAAgB,CAAC,CAAC;iBAC5C,CAAC,CACH,CAAC;aACH,CAAC,CACH;iBACA,SAAS,CAAC,UAAC,EAA0B;oBAA1B,kBAA0B,EAAzB,cAAM,EAAE,wBAAgB;gBACnC,IAAM,GAAG,GAAG,IAAI,IAAI,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,CAAC;gBACrD,IAAM,MAAM,GAAG,OAAO,CAAC;gBACvB,IAAM,GAAG,GAAG,MAAM,EAAE,CAAC;gBACrB,IAAM,QAAQ,GAAG,CAAG,gBAAgB,IAAI,KAAI,CAAC,WAAW,IAAI,KAAI,CAAC,gBAAgB,UAAI,GAAG,CAAC,MAAM,CAAC,mBAAmB,CAAC,SAAM,CAAC;gBAC3H,MAAM,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;aACvB,CAAC,CAAC;SACJ;QAED,uDAAgB,GAAhB,UACE,gBAAwB,EACxB,UAAkB,EAClB,KAAa,EACb,OAAkB,EAClB,IAAa,EACb,WAAoB,EACpB,OAAgB;YAEhB,IAAM,yBAAyB,GAAwB;gBACrD,gBAAgB,EAAE,gBAAgB;gBAClC,UAAU,EAAE,UAAU;gBACtB,KAAK,EAAE,KAAK;gBACZ,OAAO,EAAE,OAAO;gBAChB,IAAI,EAAE,IAAI;gBACV,WAAW,EAAE,WAAW;gBACxB,OAAO,EAAE,OAAO;aACjB,CAAC;YACF,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;YACvB,IAAI,IAAI,CAAC,oBAAoB,EAAE;gBAC7B,IAAI,CAAC,kBAAkB,EAAE,CAAC;aAC3B;YACD,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;SAC9D;QAED,0DAAmB,GAAnB;YACE,IAAI,UAAU,CAAC;YACf,IAAI,IAAI,CAAC,SAAS,KAAK,CAAC,EAAE;gBACxB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;gBAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,UAAU,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,gBAAgB,CACnB,IAAI,CAAC,gBAAgB,EACrB,UAAU,EACV,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,IAAI,EACT,IAAI,EACJ,IAAI,CACL,CAAC;aACH;iBAAM,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAClC,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE;oBACpE,UAAU,GAAG,CAAC,CAAC;oBACf,IAAI,CAAC,gBAAgB,CACnB,IAAI,CAAC,gBAAgB,EACrB,UAAU,EACV,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,IAAI,EACT,IAAI,EACJ,QAAQ,CACT,CAAC;iBACH;qBAAM;oBACL,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC;oBACzD,IAAI,SAAS,GAAG,CAAC,EAAE;wBACjB,SAAS,IAAI,CAAC,CAAC,CAAC;wBAChB,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;wBACjD,IAAI,CAAC,gBAAgB,CACnB,IAAI,CAAC,gBAAgB,EACrB,UAAU,EACV,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,IAAI,EACT,IAAI,CAAC,YAAY,EACjB,IAAI,CACL,CAAC;qBACH;yBAAM;wBACL,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;wBACjD,IAAI,CAAC,gBAAgB,CACnB,IAAI,CAAC,gBAAgB,EACrB,UAAU,EACV,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,IAAI,EACT,IAAI,EACJ,IAAI,CAAC,QAAQ,CACd,CAAC;qBACH;iBACF;aACF;iBAAM;gBACL,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;gBACtD,IAAI,CAAC,gBAAgB,CACnB,IAAI,CAAC,gBAAgB,EACrB,UAAU,EACV,IAAI,CAAC,YAAY,EACjB,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,IAAI,EACT,IAAI,EACJ,IAAI,CACL,CAAC;aACH;SACF;QAEa,mDAAY,GAA1B;;;;;iCACM,IAAI,CAAC,WAAW,EAAhB,wBAAgB;4BAClB,qBAAM,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAA;;4BAA/C,SAA+C,CAAC;;;;;;SAEnD;QAEa,yDAAkB,GAAhC;;;;;;;4BACQ,IAAI,GAAG,IAAI,CAAC;;4BAElB,CAAC,IAAI,CAAC,8BAA8B,IAAI,EAAE,EAAE,OAAO,CAAC,UAAC,6BAAwD;gCAC3G,IAAI,6BAA6B,EAAE;oCACjC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAO,GAAQ;;;;;oDAC9B,sBAAsB,GAAG,6BAA6B,CAAC,sBAAsB;wDACjF,6BAA6B,CAAC,sBAAsB,GAAG,cAAM,OAAA,CAAC,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,GAAA,CAAC;oDAGlF,WAAW,GAAG,6BAA6B,CAAC,aAAa;wDAC3D,6BAA6B,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;oDAEzE,KAAK,GAAU,MAAM,CAAC,6BAA6B,CAAC,KAAK,CAAC,CAAC;oDACjE,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC,OAAO,CAC3C,YAAY,EACZ,WAAW,CACZ,CAAC;oDAEgC,qBAAM,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAC9E,IAAI,EACJ,6BAA6B,CAAC,kBAAkB,EAChD,KAAK,EACL,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,aAAa,EAClB,sBAAsB,EACtB,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,EAChB,6BAA6B,CAAC,SAAS,EACvC,6BAA6B,CAAC,aAAa,CAC5C,EAAA;;oDAVK,yBAAyB,GAAG,SAUjC;oDACD,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;;;;yCAClE,CAAC,CAAC;iCACJ;6BACF,CAAC,CAAC;iCAEC,IAAI,CAAC,6BAA6B,EAAlC,wBAAkC;;4BAEpC,KAAA,CAAA,KAAA,IAAI,CAAC,2BAA2B,EAAC,IAAI,CAAA;4BACnC,qBAAM,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAC5C,IAAI,EACJ,IAAI,CAAC,6BAA6B,CAAC,kBAAkB,EACrD,IAAI,CAAC,6BAA6B,CAAC,KAAK,EACxC,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,aAAa,EAClB,cAAM,OAAA,CAAC,GAAA,CACR,EAAA;;;4BARH,cACE,SAOC,EACF,CAAC;;;;;;SAEL;QAEO,wEAAiC,GAAzC;YACE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,4BAA4B,CAAC,EAAE;gBAChD,IAAI,CAAC,eAAe,CAAC,uBAAuB,CAAC,IAAI,CAAC,4BAA4B,CAAC,CAAC;aACjF;SACF;QAED,0DAAmB,GAAnB;YACE,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;YAC7E,IAAI,CAAC,2BAA2B,GAAG,EAAE,CAAC;SACvC;QAED,gDAAS,GAAT,UAAU,OAAY;YACpB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAClC;QAED,oDAAa,GAAb,UAAc,OAAY;YACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACtC;QAED,mDAAY,GAAZ,UAAa,OAAY;YACvB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrC;QAED,gDAAS,GAAT,UAAU,OAAY;YACpB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAClC;QAED,gDAAS,GAAT,UAAU,cAAoC,EAAE,gBAAyB;YACvE,IAAI,cAAc,EAAE;gBAClB,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,EAAE,mBAAmB,EAAE,cAAc,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,CAAC,CAAC;aACnH;iBAAM;gBACL,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;gBAC5D,IAAM,+BAA+B,GAAwB;oBAC3D,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;oBACvC,UAAU,EAAE,UAAU;oBACtB,KAAK,EAAE,OAAO;oBACd,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,IAAI,EAAE,IAAI,CAAC,IAAI;iBAChB,CAAC;gBAEF,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,EAAE,mBAAmB,EAAE,+BAA+B,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,CAAC,CAAC;aACpI;SACF;;QAGD,yDAAkB,GAAlB;YACE,IAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;YACjB,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;YAC9B,CAAC,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;YACtC,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,IAAI,EAAE,CAAC;SACxD;QAED,yDAAkB,GAAlB;YACE,IAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;YACjB,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,IAAI,EAAE,CAAC;YACvD,IAAI,IAAI,CAAC,uBAAuB,GAAG,IAAI,GAAG,KAAK,EAAE;gBAC/C,IAAI,CAAC,0BAA0B,EAAE,CAAC;aACnC;SACF;QAED,iEAA0B,GAA1B;YACE,IAAM,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;YACjB,IAAM,OAAO,GAAG,MAAM,CAAC,WAAW,CAAC;YACnC,IAAM,uBAAuB,GAAG,EAAE,CAAC;YACnC,IAAM,wBAAwB,GAAG,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,uBAAuB,CAAC;YACxG,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;YACpC,CAAC,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;YACnC,IAAI,OAAO,GAAG,wBAAwB,EAAE;gBACtC,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;gBAC5E,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAK,MAAM,CAAC,WAAW,OAAI,CAAC,CAAC;gBACzF,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;gBACrE,IAAM,gBAAgB,GAAG,uBAAuB,CAAC;gBACjD,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,YAAY,EAAK,gBAAgB,OAAI,CAAC,CAAC;aAC5F;iBAAM;gBACL,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;gBACzE,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;gBACtE,CAAC,CAAC,oCAAkC,IAAI,CAAC,GAAK,CAAC,CAAC,GAAG,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aAC1E;SACF;QA1hBSC;YAATC,WAAM,EAAE;sCAAgBP,iBAAY;2EAA2B;QACtDM;YAATC,WAAM,EAAE;sCAAoBP,iBAAY;+EAA2B;QAC1DM;YAATC,WAAM,EAAE;sCAAmBP,iBAAY;8EAA2B;QACzDM;YAATC,WAAM,EAAE;sCAAgBP,iBAAY;2EAA2B;QACtDM;YAATC,WAAM,EAAE;sCAA4BP,iBAAY;uFAA2B;QAClEM;YAATC,WAAM,EAAE;sCAAuBP,iBAAY;kFAA2B;QAC7DM;YAATC,WAAM,EAAE;sCAA2BP,iBAAY;sFAA2B;QACjEM;YAATC,WAAM,EAAE;sCAA8BP,iBAAY;yFAA2B;QAErEM;YAARE,UAAK,EAAE;;gFAAyB;QACxBF;YAARE,UAAK,EAAE;;qEAAc;QACbF;YAARE,UAAK,EAAE;;uEAAmB;QAClBF;YAARE,UAAK,EAAE;;iFAA6B;QAC5BF;YAARE,UAAK,EAAE;;yEAAuB;QACtBF;YAARE,UAAK,EAAE;;4FAAkE;QACjEF;YAARE,UAAK,EAAE;;2FAA0D;QACzDF;YAARE,UAAK,EAAE;;8EAA0B;QACzBF;YAARE,UAAK,EAAE;;qEAA0B;QACzBF;YAARE,UAAK,EAAE;;kEAAqB;QACpBF;YAARE,UAAK,EAAE;;uEAAe;QACdF;YAARE,UAAK,EAAE;;0EAAsB;QACrBF;YAARE,UAAK,EAAE;;8EAA2B;QAC1BF;YAARE,UAAK,EAAE;;kFAAqC;QACpCF;YAARE,UAAK,EAAE;;yEAAkB;QACjBF;YAARE,UAAK,EAAE;;0FAA6D;QAC5DF;YAARE,UAAK,EAAE;;kFAA6B;QAC5BF;YAARE,UAAK,EAAE;;qFAAiC;QAChCF;YAARE,UAAK,EAAE;;0EAAwB;QACvBF;YAARE,UAAK,EAAE;;2EAAyB;QAExBF;YAARE,UAAK,EAAE;;uEAAmB;QAhChB,4BAA4B;YARxCC,cAAS,CAAC;gBACT,QAAQ,EAAE,2BAA2B;gBACrC,y/EAAqD;gBAIrD,eAAe,EAAEC,4BAAuB,CAAC,MAAM;;aAChD,CAAC;YA6KGC,WAAAC,WAAM,CAAC,QAAQ,CAAC,CAAA;qDACUC,sBAAiB;gBACrB,aAAa;gBACX,eAAe;gBACX,mBAAmB;WAhLvC,4BAA4B,CA6hBxC;QAAD,mCAAC;KA7hBD;;;QCnDE,2BAAmB,gBAAkC;YAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;SAAK;QAD/C,iBAAiB;YAH7BC,cAAS,CAAC;gBACT,QAAQ,EAAE,wBAAwB;aACnC,CAAC;6CAEqCC,qBAAgB;WAD1C,iBAAiB,CAE7B;QAAD,wBAAC;KAFD;;;QCgCE,qCAAoB,wBAAkD;YAAlD,6BAAwB,GAAxB,wBAAwB,CAA0B;YAX7D,SAAI,GAAQ,EAAE,CAAC;YACf,YAAO,GAAQ,EAAE,CAAC;YACjB,kBAAa,GAAsB,IAAIf,iBAAY,EAAE,CAAC;YACtD,sBAAiB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAC1D,qBAAgB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YACzD,kBAAa,GAAsB,IAAIA,iBAAY,EAAE,CAAC;SAMU;QAE1E,8CAAQ,GAAR;;SAEC;QAED,qDAAe,GAAf;YACE,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,IAAI,CAAC,cAAc,EAAE;gBACvB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;gBACtC,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;aACjC;SACF;QAED,iDAAW,GAAX,UAAY,OAAsB;YAChC,IAAM,IAAI,GAAG,IAAI,CAAC;YAClB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACzC,WAAW,CAAC,OAAO,CAAC,UAAC,GAAG;oBACrB,IAAI,CAAC,YAAY,CAAC,QAAkC,CAAC,GAAG,CAAC;wBACxD,OAAO,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC;iBAC7B,CAAC,CAAC;gBACF,IAAI,CAAC,YAAY,CAAC,QAAkC,CAAC,WAAW,CAC/D,OAAO,CACR,CAAC;aACH;iBAAM;gBACL,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;aAC/B;SACF;QAED,mDAAa,GAAb;YACE,IAAM,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAC5E,IAAI,CAAC,kBAAkB,CACxB,CAAC;YACF,IAAM,gBAAgB,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC;YACxD,gBAAgB,CAAC,KAAK,EAAE,CAAC;YAEzB,IAAI,CAAC,YAAY,GAAG,gBAAgB,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;YACtE,IAAI,CAAC,YAAY,CAAC,QAAkC,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;YACtE,IAAI,CAAC,YAAY;iBACf,QAAkC,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC;YAC1E,IAAI,CAAC,YAAY;iBACf,QAAkC,CAAC,mBAAmB,GAAG,IAAI,CAAC,iBAAiB,CAAC;YAClF,IAAI,CAAC,YAAY;iBACf,QAAkC,CAAC,kBAAkB,GAAG,IAAI,CAAC,gBAAgB,CAAC;YAChF,IAAI,CAAC,YAAY;iBACf,QAAkC,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC;;YAE1E,IAAI,CAAC,YAAY;iBACf,QAAkC,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YAC5D,IAAI,CAAC,YAAY,CAAC,QAAkC,CAAC,QAAQ,EAAE,CAAC;SAClE;QA/DQM;YAARE,UAAK,EAAE;;+EAAyB;QACxBF;YAARE,UAAK,EAAE;;iEAAgB;QACfF;YAARE,UAAK,EAAE;;oEAAmB;QACjBF;YAATC,WAAM,EAAE;sCAAgBP,iBAAY;0EAA2B;QACtDM;YAATC,WAAM,EAAE;sCAAoBP,iBAAY;8EAA2B;QAC1DM;YAATC,WAAM,EAAE;sCAAmBP,iBAAY;6EAA2B;QACzDM;YAATC,WAAM,EAAE;sCAAgBP,iBAAY;0EAA2B;QAIfM;YAAhDU,cAAS,CAAC,iBAAiB,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;sCAAW,iBAAiB;qEAAC;QAZlE,2BAA2B;YANvCP,cAAS,CAAC;gBACT,QAAQ,EAAE,0BAA0B;gBACpC,8IAAoD;gBAEpD,eAAe,EAAEC,4BAAuB,CAAC,MAAM;;aAChD,CAAC;6CAe8CO,6BAAwB;WAd3D,2BAA2B,CAkEvC;QAAD,kCAAC;KAlED;;;;QCjBE;SAAiB;QACjB,2CAAiB,GAAjB,UAAkB,SAAS;YACzB,OAAOnB,uBAAU,CAAI,SAAS,YAAS,CAAC,CAAC;;;;;SAK1C;QATU,eAAe;YAD3BD,eAAU,EAAE;;WACA,eAAe,CAU3B;QAAD,sBAAC;KAVD;;eC6BqC,aAAa;AAKlD;QAAA;SAAyC;QAA5B,yBAAyB;YAtBrCqB,aAAQ,CAAC;gBACR,YAAY,EAAE;oBACZ,4BAA4B;oBAC5B,2BAA2B;oBAC3B,iBAAiB;iBAElB;gBACD,OAAO,EAAE,CAACC,mBAAY,CAAC;gBACvB,OAAO,EAAE;oBACP,4BAA4B;iBAC7B;gBACD,SAAS,EAAE;oBACT,aAAa;oBACb,eAAe;oBACf,mBAAmB;oBACnB,WAAW;oBACX,eAAe;oBACf,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,MAAe,EAAE;;;iBAGjD;aACF,CAAC;WACW,yBAAyB,CAAG;QAAD,gCAAC;KAAzC;;;ICtCA,WAAY,cAAc;QACxB,iCAAe,CAAA;QACf,yCAAuB,CAAA;QACvB,2BAAS,CAAA;QACT,6BAAW,CAAA;QACX,uCAAqB,CAAA;QACrB,uCAAqB,CAAA;QACrB,2CAAyB,CAAA;QACzB,iDAA+B,CAAA;QAC/B,mCAAiB,CAAA;QACjB,yCAAuB,CAAA;IACzB,CAAC,EAXWC,sBAAc,KAAdA,sBAAc,QAWzB;;;ICXD,WAAY,aAAa;QACvB,4BAAW,CAAA;QACX,8BAAa,CAAA;IACf,CAAC,EAHWC,qBAAa,KAAbA,qBAAa,QAGxB;;;ICHD,WAAY,oBAAoB;QAC9B,mCAAW,CAAA;QACX,iCAAS,CAAA;IACX,CAAC,EAHWC,4BAAoB,KAApBA,4BAAoB,QAG/B;;;QCwBC,+BAAsB,iBAAqC;YAA3D,iBAA+D;YAAzC,sBAAiB,GAAjB,iBAAiB,CAAoB;;YAb3D,oBAAe,GAAsB,IAAItB,iBAAY,EAAE,CAAC;YACxD,wBAAmB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAC5D,uBAAkB,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAC3D,oBAAe,GAAsB,IAAIA,iBAAY,EAAE,CAAC;YAKhD,eAAU,GAAc,IAAIuB,eAAS,CAAC,EAAE,CAAC,CAAC;YAC1C,mBAAc,GAAa,EAAE,CAAC;YAkCtC,2BAAsB,GAAG,UAAC,QAA2B;gBACnD,KAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;aAC3B,CAAA;YAED,aAAQ,GAAG,UAAC,YAAoB,EAAE,UAAe;gBAC/C,IAAM,sBAAsB,GAAG;oBAC7B,YAAY,EAAE,YAAY;oBAC1B,EAAE,EAAE,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAI,CAAC,cAAc,CAAC;oBACtC,IAAI,EAAE,UAAU;iBACjB,CAAC;gBACF,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;aACnD,CAAA;YAED,iBAAY,GAAG,UAAC,UAAkB,EAAE,QAAgC;gBAClE,IAAM,sBAAsB,GAAG;oBAC7B,UAAU,EAAE,UAAU;oBACtB,QAAQ,EAAE,QAAQ;iBACnB,CAAC;gBACF,KAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;aACvD,CAAA;YAED,gBAAW,GAAG,UAAC,SAAS,EAAE,IAAI;gBAC5B,IAAM,sBAAsB,GAAG;oBAC7B,SAAS,EAAE,SAAS;oBACpB,EAAE,EAAE,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAI,CAAC,cAAc,CAAC;oBACtC,IAAI,EAAE,IAAI;iBACX,CAAC;gBACF,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;aACtD,CAAA;YAED,aAAQ,GAAG,UAAC,UAAgB;gBAC1B,IAAM,sBAAsB,GAAG;oBAC7B,EAAE,EAAE,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAI,CAAC,cAAc,CAAC;oBACtC,IAAI,EAAE,UAAU;iBACjB,CAAC;gBACF,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;aACnD,CAAA;;YAGD,sBAAiB,GAAG,UAAC,SAAoB;gBACvC,KAAI,CAAC,UAAU,GAAG,SAAS,CAAC;aAC7B,CAAA;SAvE8D;QAE/D,wCAAQ,GAAR,eAAmB;QAEnB,2CAAW,GAAX,UAAY,OAAsB;YAAlC,iBAwBC;YAvBC,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aACzB;YAED,IAAM,WAAW,GAAG,OAAO,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACpE,IAAI,WAAW,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE;gBAChD,IAAM,SAAO,GAAI,WAAmB,CAAC,IAAI,EAAE,CAAC;gBAE5C,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,UAAC,GAAG;oBAC9B,IAAM,QAAQ,GAAG,SAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBACnC,IAAM,QAAQ,GAAG,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;oBAEhD,IAAI,QAAQ,KAAK,QAAQ,EAAE;wBACzB,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;qBAC9E;iBACF,CAAC,CAAC;aAEJ;YAGD,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;aACxC;SACF;QA6CD,iDAAiB,GAAjB,UAAkB,YAAoB,EAAE,YAAiB,EAAE,UAAsB;YAC/E,IAAM,WAAW,GAAG,IAAIC,iBAAW,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;YAC9D,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;YACtD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACvC,OAAO,WAAW,CAAC;SACpB;QAEH,4BAAC;IAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;"}